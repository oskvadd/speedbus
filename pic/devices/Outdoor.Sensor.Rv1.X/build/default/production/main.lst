MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (List)
                      00001 List      P=16f690              ; list directive to define processor
                      00002 
                      00003 #include "p16f690.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F690 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00756         LIST
                      00004 
                      00005 ; CONFIG
                      00006 ; __CONFIG _CONFIG1, 0x30D5
2007   30D4           00007  __CONFIG _INTOSCIO & _WDTE_OFF & _PWRTE_OFF & _MCLRE_OFF & _CP_OFF & _CPD_OFF & _BOREN_OFF & _IESO_OFF 
                            & _FCMEN_OFF
                      00008 
                      00009 ; RA1 = Check for led strip 1
                      00010 ; RC2 = Check for led strip 2
                      00011 ; RB6 = Controller for fan
                      00012 
                      00013 ; RA5 = Temp in grow house
                      00014 ; RA4 = Temp for heat sink
                      00015 
                      00016 
                      00017 
                      00018 ; IMPORTATNT! All the speedlib pre definitions, MUST be definde before the include
                      00019 #define ARC_16F             1
                      00020 ;#define ARC_18F            1
                      00021 #define REC_CUSTOM_JUMP     custom_command_handler
                      00022 #define REC_SPB_PARAMETERS  spb_parameters
                      00023 ;#define CUSTOM_INTERRUPT   c_intserv
                      00024 #define DEV_ID4             200
                      00025 #define WRITE_EEPROM        write_eeprom
                      00026 #define READ_EEPROM         read_eeprom
                      00027 #include "../SpeedBus.PIC.LibV2.X/speedlibV2_main.asm"
                      00001 ; Well, so this is v2 of the speedbus PIC library. Because i did not want to brake a whole lot of code,
                      00002 ; when writing on some new changes, i wrote a new version of the speedbus library.
                      00003 ;
                      00004 ; The new library will have som new futures, like storing STATUS registers and etc in the
                      00005 ; bank independent memmory. Instead of the old buggy memmory handling.
                      00006 ; And the biggest change will be the move from the old main bank (0), to a bank chosen
                      00007 ; bye you. And will probebly make you able to have mouch more memmory to use.
                      00008 ;
                      00009 ; Suport for the old library will be limited. i will make an pilot commit on this one,
                      00010 ; so i can look over the canges later.
                      00011 ;
                      00012 ; 140519 18:58
                      00013 
                      00014 #include "../SpeedBus.PIC.LibV2.X/speedlibV2_main.inc"
                      00001 ;
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00002 ; Define macros for speedbus!
                      00003 ;
                      00004 ;
                      00005 ; 150111 20:54 - Speedster
                      00006 ;
                      00007 
                      00008 if_parameter macro _if, jumpto
                      00009         movlw   _if
                      00010     bankisel rcframe
                      00011         subwf   INDF,W
                      00012         btfsc   STATUS,Z
                      00013     goto    jumpto
Warning[205]: Found directive in column 1. (endm)
                      00014 endm
                      00015 
                      00016 #ifndef OUTREG
                      00017 #define OUTREG PORTB
                      00018 #endif
                      00019 #ifndef OUTNUM
                      00020 #define OUTNUM 4
                      00021 #endif
                      00022 
                      00023 
                      00024 #ifndef DEV_ID1
                      00025 #define DEV_ID1 0
                      00026 #endif
                      00027 #ifndef DEV_ID2
                      00028 #define DEV_ID2 0
                      00029 #endif
                      00030 #ifndef DEV_ID3
                      00031 #define DEV_ID3 0
                      00032 #endif
                      00033 #ifndef DEV_ID4
                      00034 #define DEV_ID4 0
                      00035 #endif
                      00036 
                      00037 #ifndef FSR
                      00038 #define FSR FSR1L
                      00039 #endif
                      00040 
                      00041 #ifndef INDF
                      00042 #define INDF INDF1
                      00043 #endif
                      00044 
                      00045 #ifndef EEDAT
                      00046 #define EEDAT EEDATA
                      00047 #endif
                      00048 
                      00049 #define SPEEDLIB_RESPONSE_DELAY 9
                      00050 
Warning[205]: Found directive in column 1. (radix)
                      00051 radix dec
                      00052 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00053 #define     USER_VARIABLE_SPACE     0x20
                      00054 #define     USER_NO_BANK_SPACE      0x67
                      00055 
                      00056 ; Remember that d1, d2, d3, d4 is stored i the same bank as cblock, 0xA0 = bank nr1.
                      00057         cblock  0xA0
  000000A0            00058              d1                 ; Define three file registers for the
  000000A1            00059          d2                     ; delay loop. Make sure all these(d1,d2,d3) is in the same bank
  000000A2            00060              d3
  000000A3            00061              d4
  000000A4            00062              rand
  000000A5            00063              rc_listen              ; |X-------|b7 = NoNE
                      00064                                 ; |-X------|b6 = NoNE
                      00065                                 ; |--X-----|b5 = This bit is used as the old "rc_gotflag", sets to 1, if
                             it "got a flag".
                      00066                                 ; |---X----|b4 = This bit specifies, that when reciving an 0x01, destion
                            ated for ME, do not send a "is ocupied package". This is good if you want to "search for units"
                      00067                                 ; |----X---|b3 = This bit got set if the device recive a usual response 
                            package (0x00)
                      00068                                 ; |-----X--|b2 = This is an internal function for the recsave rutine, so
                             the cewd know that following byte is escaped.
                      00069                                 ; |------X-|b1 = If you set this bit to 1 the cewd will handle the byte 
                            as loopback, and if it dosent match the byte in rc_nocoll
                      00070                                 ; |-------X|b0 = If you set this bit to one, when the device recives a "
                            is ocupied" pack, itn will uncheck this bit.
                      00071                                 ;                If this bit is zero, the device will send a "i am ocupi
                            ed" pack.
  000000A6            00072              rc_counter         ; RC framelen
  000000A7            00073              rc_nocoll          ; Use this to confim that no collission has ocurred
  000000A8            00074              rc_add_byte        ; recsave_add temporary argument
  000000A9            00075          rsp_adress1    ; The response adress at the bus
  000000AA            00076              rsp_adress2        ; The response adress at the bus
  000000AB            00077              adress1            ; The adress at the bus
  000000AC            00078              adress2            ; The adress at the bus
  000000AD            00079              speedlib_config        ; |X-------|b7 = NoNE
                      00080                                 ; |-X------|b6 = NoNE
                      00081                                 ; |--X-----|b5 = NoNE
                      00082                                 ; |---X----|b4 = NoNE
                      00083                                 ; |----X---|b3 = NoNe
                      00084                                 ; |-----X--|b2 = NoNe
                      00085                                 ; |------X-|b1 = Set this bit 1 if adress is stamped.
                      00086                                 ; |-------X|b0 = On, Off this bit, if you want to make the device check 
                            the adress on startup.
  000000AE            00087              crc0
  000000AF            00088              crc1
  000000B0            00089              crcloop
  000000B1            00090              crctmp
  000000B2            00091              framelen           ; TX framelen
  000000B3            00092              txtmp              ; temporary before sending
  000000B4            00093              txreturn           ; Hardcoded return, if nessesary(in interupts)
                      00094          ;; IMPORTANT - Make sure that txframe and its 20bytes is in the same register,
                      00095          ;; and that rcframe and its 20bytes is in the same registers.
  000000B5            00096              txframe, tx1, tx2, tx3, tx4, tx5, tx6, tx7, tx8, tx9, tx10 ; Current package limit, 20B
  000000C0            00097              tx11, tx12, tx13, tx14, tx15, tx16, tx17, tx18, tx19, tx20
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000000CA            00098              rcframe, rc1, rc2, rc3, rc4, rc5, rc6, rc7, rc8, rc9, rc10 ; Current package limit, 20B
  000000D5            00099              rc11, rc12, rc13, rc14, rc15, rc16, rc17, rc18, rc19, rc20
                      00100         endc
                      00101 
                      00102     ; Bank independent memmory.
                      00103         cblock  0x70
  00000070            00104              tmp_W
  00000071            00105              tmp_STATUS
  00000072            00106              d1_tmp
  00000073            00107              d2_tmp
  00000074            00108              d3_tmp
  00000075            00109              speedlib_main          ; |X-------|b7 = NoNE    ;;-> speedlib_main is stored because of b0 
                            and b1
                      00110                                 ; |-X------|b6 = NoNE
                      00111                                 ; |--X-----|b5 = NoNE
                      00112                                 ; |---X----|b4 = NoNE
                      00113                                 ; |----X---|b3 = NoNe
                      00114                                 ; |-----X--|b2 = If this bit got set, the cewd will send a response pack
                            age when returning to restore
                      00115                                 ; |------X-|b1 = This bit should be set, if the device has sent an packa
                            ge, that should be responde to
                      00116                                 ; |-------X|b0 = This bit, is SET when an interupt has occured. If you s
                            et this to zero before youre rutine, and check the bit after, you will se if an interupt has ocu
                      00117 
                      00118     endc
                      00119 
                      00120         ;; EEPROM
                      00121         ;; 0x00 ; addr1
                      00122         ;; 0x01 ; addr2
                      00123         ;; 0x02 ; Speedbus configuration register
                      00124 
                      00125 .code_page0_ CODE
                      00126 
0000                  00127 init_speedlib:
                      00128 #ifndef FSR
                      00129     banksel FSR1H
                      00130     clrf    FSR1H
                      00131 #endif
                      00132 
                      00133 
                      00134     ;; Preset some values
0000   1283 1303      00135     banksel speedlib_main
0002   1175           00136     bcf     speedlib_main,2
0003   10F5           00137     bcf     speedlib_main,1
0004   1283 1303      00138     banksel OUTREG
0006   1206           00139     bcf     OUTREG,OUTNUM
0007   1683 1303      00140     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0009   10A5           00141     bcf     rc_listen,1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000A   1225           00142     bcf     rc_listen,4
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000B   12A5           00143     bcf     rc_listen,5         ;; Clear got flag
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C   1683 1303      00144     banksel txreturn
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000E   10B4           00145     bcf     txreturn, 1
                      00146 
                      00147 #ifdef  READ_EEPROM
                      00148     ;; Take adress from eeprom, if it is set.
000F   3000           00149     movlw   0
0010   2???           00150     call    READ_EEPROM
0011   1683 1303      00151     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0013   00AB           00152     movwf   adress1
0014   3001           00153     movlw   1
0015   2???           00154     call    READ_EEPROM
0016   1683 1303      00155     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0018   00AC           00156     movwf   adress2
0019   3002           00157     movlw   2
001A   2???           00158     call    READ_EEPROM
001B   1683 1303      00159     banksel speedlib_config
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001D   00AD           00160     movwf   speedlib_config
                      00161 #endif
                      00162 
                      00163     ;; If adress is 255.255, change to 0.0
001E   30FF           00164     movlw       0xFF
001F   1683 1303      00165     banksel     adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0021   022B           00166     subwf       adress1,W
0022   1D03           00167     btfss       STATUS,Z
0023   0008           00168     return
0024   30FF           00169     movlw       0xFF
0025   1683 1303      00170     banksel     adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0027   022C           00171     subwf       adress2,W
0028   1D03           00172     btfss       STATUS,Z
0029   0008           00173     return
                      00174 
002A   1683 1303      00175     banksel     adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002C   01AB           00176     clrf        adress1
002D   1683 1303      00177     banksel     adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002F   01AC           00178     clrf        adress2
                      00179 
                      00180 #ifdef  WRITE_EEPROM
0030   3000           00181     movlw   0
0031   1683 1303      00182     banksel rc_nocoll
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0033   00A7           00183     movwf   rc_nocoll
0034   1683 1303      00184     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0036   082B           00185     movf    adress1,W
0037   2???           00186     call    WRITE_EEPROM
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0038   1683 1303      00187     banksel rc_nocoll
003A   3001           00188     movlw   1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003B   00A7           00189     movwf   rc_nocoll
003C   1683 1303      00190     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003E   082C           00191     movf    adress2,W
003F   2???           00192     call    WRITE_EEPROM
                      00193 #endif
                      00194 
                      00195     ;; Because the dreprecated version of the fucked up "checkaddr" function,
                      00196     ;; i removed the code. In wait for the new system.
                      00197     ;;
                      00198     ;; Handle response, needs testing.
                      00199 
0040   0008           00200     return
                      00201 
                      00202 
0041                  00203 intserv:
0041   1475           00204     bsf     speedlib_main,0     ;; Set this bit to one, when an interupt ocurres
                      00205 
0042   1CF5           00206     btfss       speedlib_main,1     ;; Waiting for response STATE? Jump direct to recend_no_broadcast
0043   2???           00207     goto    intserv_norm
0044   1283 1303      00208     banksel PIR1
0046   1A8C           00209     btfsc       PIR1,RCIF           ;; Check if the recived data bit is set
0047   2???           00210         goto    rec                 ;; Jump to recive data rutine if the PIR1 bit is 1
0048   2???           00211     goto    restore             ;; In waiting for response state, all other interupt than rec, will be d
                            roped.
                      00212 
0049                  00213 intserv_norm:
0049   00F0           00214         movwf   tmp_W               ;; Register BKP before the interup code exec
004A   0803           00215         movf    STATUS,W
004B   0183           00216         clrf    STATUS
004C   00F1           00217         movwf   tmp_STATUS
004D   1683 1303      00218     banksel d1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004F   0820           00219         movf    d1,W
0050   00F2           00220         movwf   d1_tmp
0051   1683 1303      00221     banksel d2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0053   0821           00222         movf    d2,W
0054   00F3           00223         movwf   d2_tmp
0055   1683 1303      00224     banksel d3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0057   0822           00225         movf    d3,W
0058   00F4           00226         movwf   d3_tmp
                      00227 #ifdef  CUSTOM_INTERRUPT
                      00228     goto    CUSTOM_INTERRUPT
                      00229 ci_restore:
                      00230 #endif
                      00231 
0059   1283 1303      00232     banksel PIR1
005B   1A8C           00233         btfsc   PIR1,RCIF           ;; Check if the recived data bit is set
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005C   2???           00234         goto    rec                 ;; Jump to recive data rutine if the PIR1 bit is 1
                      00235 
                      00236 
005D                  00237 restore:
005D   18F5           00238     btfsc       speedlib_main,1     ;; Waiting for response STATE? Dont
005E   0009           00239     retfie                      ;; restore saved, nothing is saved
                      00240 
                      00241                                 ;;; If:  Send back a response package, to confirm that the package has b
                            een recived
                      00242 ;;  btfss   speedlib_main,2
                      00243 ;;  goto    restore_norm
                      00244 ;;  bcf     speedlib_main,2
                      00245 ;;  call    func_send_response
                      00246                                 ;;;
                      00247 
005F                  00248 restore_norm:
005F   0872           00249         movf    d1_tmp,W
0060   1683 1303      00250     banksel d1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0062   00A0           00251         movwf   d1
0063   0873           00252         movf    d2_tmp,W
0064   1683 1303      00253     banksel d2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0066   00A1           00254         movwf   d2
0067   0874           00255         movf    d3_tmp,W
0068   1683 1303      00256     banksel d3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
006A   00A2           00257         movwf   d3      
006B   0871           00258         movf    tmp_STATUS,W
006C   0083           00259         movwf   STATUS
006D   0870           00260     movf    tmp_W, W
006E   0009           00261         retfie  
                      00262 
006F                  00263 rec:
006F   1683 1303      00264     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0071   1CA5           00265         btfss   rc_listen,1         ;; If rc_listen is set to NOT drop the loopback package, jump direct
                            ly to the rec_start
0072   2???           00266         goto    rec_start               
                      00267 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0073   10A5           00268         bcf     rc_listen,1         ;; Start this rutine with checking that the recived bit NOT was send
                             from this own device
0074   1683 1303      00269         banksel rc_nocoll
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0076   0827           00270     movf        rc_nocoll,W
0077   1283 1303      00271     banksel RCREG
0079   021A           00272         subwf   RCREG,W
007A   1D03           00273         btfss   STATUS,Z
007B   2???           00274         goto    rec_oops_coll           ;; Anyway, if the rc_listen,1  is 1, and it do not match RCREG, 
                            we may be detected an collission
007C   2???           00275         goto    restore
                      00276 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007D                  00277 rec_oops_coll:
007D   1683 1303      00278     banksel txreturn
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
007F   14B4           00279         bsf     txreturn,1
0080   2???           00280         goto    restore
                      00281         
0081                  00282 rec_start:
0081   1283 1303      00283     banksel RCREG
0083   307E           00284         movlw   0x7e
0084   021A           00285         subwf   RCREG,W
0085   1903           00286         btfsc   STATUS,Z
0086   2???           00287         goto    recx                ;; Jump if this is a flag bit
0087   1683 1303      00288     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0089   1AA5           00289         btfsc   rc_listen,5
008A   2???           00290         goto    recsave             ;; Jump if the flag bit is set
008B   2???           00291         goto    restore
                      00292 
008C                  00293 recx:
008C   1683 1303      00294     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
008E   1AA5           00295         btfsc   rc_listen,5
008F   2???           00296         goto    recend              ;; If this may be end flag, check the package, finalize, check crc
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0090   16A5           00297         bsf     rc_listen,5         ;; Else set the gotflag, and start recording package!
0091   1683 1303      00298         banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0093   01A6           00299     clrf        rc_counter          ;; Clear the counter :)
0094   2???           00300         goto    restore
                      00301 
0095                  00302 recsave:
0095   1283 1303      00303     banksel RCREG
0097   307D           00304         movlw   0x7d
0098   021A           00305         subwf   RCREG,W
0099   1903           00306         btfsc   STATUS,Z
009A   2???           00307         goto    recsave_set         ;; Set bit in the rc_listen to aktivate escape routines when the nex
                            t byte is recived
009B   1683 1303      00308         banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
009D   1925           00309     btfsc   rc_listen,2
009E   2???           00310         goto    recsave_unescape
                      00311 
009F   1283 1303      00312     banksel RCREG
00A1   081A           00313         movf    RCREG,W
00A2   2???           00314         goto    recsave_add
                      00315 
00A3                  00316 recsave_set:
00A3   1683 1303      00317     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00A5   1525           00318         bsf     rc_listen,2
00A6   2???           00319         goto    restore
                      00320 
00A7                  00321 recsave_unescape:
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A7   1683 1303      00322     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00A9   1125           00323         bcf     rc_listen,2
00AA   305E           00324         movlw   0x5e
00AB   1283 1303      00325     banksel RCREG
00AD   021A           00326         subwf   RCREG,W
00AE   1903           00327         btfsc   STATUS,Z
00AF   2???           00328         goto    recsave_unescape_1
00B0   305D           00329         movlw   0x5d
00B1   021A           00330         subwf   RCREG,W
00B2   1903           00331         btfsc   STATUS,Z
00B3   2???           00332         goto    recsave_unescape_2
00B4   2???           00333         goto    restore             ;; Maybe you can change this, but a fail package that is the result,
                             will also be CRC checked
                      00334         
00B5                  00335 recsave_unescape_1:
00B5   307E           00336         movlw   0x7e
00B6   2???           00337         goto    recsave_add
00B7                  00338 recsave_unescape_2:
00B7   307D           00339     movlw   0x7d
00B8   2???           00340         goto    recsave_add
                      00341         
00B9                  00342 recsave_add:
00B9   1683 1303      00343     banksel rc_add_byte
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BB   00A8           00344         movwf   rc_add_byte
00BC   30CA           00345     movlw       rcframe             ;; Place where to put the receiving byte
00BD   1683 1303      00346     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BF   0726           00347     addwf       rc_counter,W        ;; Add the number in rc_flow, to the pointer, like rcframe[rc_flow]
00C0   0084           00348     movwf       FSR
00C1   1683 1303      00349     banksel rc_add_byte
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C3   0828           00350         movf    rc_add_byte,W
00C4   1383           00351     bankisel rcframe
00C5   0080           00352         movwf   INDF
00C6   1683 1303      00353     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C8   0AA6           00354         incf    rc_counter,F
00C9   2???           00355         goto    restore
                      00356         
00CA                  00357 recend:
00CA   3005           00358     movlw   5
00CB   1683 1303      00359     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00CD   0226           00360     subwf   rc_counter,W
00CE   1C03           00361     btfss   STATUS,C
00CF   2???           00362     goto    reccrcfail
00D0   1683 1303      00363     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D2   0326           00364         decf    rc_counter,W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D3   00A6           00365         movwf   rc_counter
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D4   1683 1303      00366     banksel crcloop
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D6   00B0           00367         movwf   crcloop
00D7   30CA           00368         movlw   rcframe
00D8   1283 1303      00369     banksel FSR
00DA   0084           00370         movwf   FSR
00DB   1683 1303      00371     banksel crc0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00DD   01AE           00372         clrf    crc0
00DE   1683 1303      00373     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00E0   01AF           00374         clrf    crc1
00E1   2???           00375         call    crcloopr        ; Call CRC function
                      00376 
                      00377 
00E2   30CA           00378         movlw   rcframe
00E3   1683 1303      00379     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00E5   0726           00380         addwf   rc_counter,W
00E6   0084           00381         movwf   FSR
                      00382 
00E7   1383           00383     bankisel rcframe
00E8   0800           00384         movf    INDF,W
                      00385 
00E9   1683 1303      00386     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00EB   022F           00387         subwf   crc1,W
00EC   1D03           00388         btfss   STATUS,Z
00ED   2???           00389         goto    reccrcfail
00EE   0304           00390         decf    FSR,W
00EF   0084           00391         movwf   FSR
                      00392 
00F0   1383           00393     bankisel rcframe
00F1   0800           00394         movf    INDF,W
                      00395 
00F2   1683 1303      00396     banksel crc0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F4   022E           00397         subwf   crc0,W
00F5   1D03           00398         btfss   STATUS,Z
00F6   2???           00399         goto    reccrcfail
                      00400 
00F7   1683 1303      00401         banksel rc_listen           ;; REMEMBER, if checksum is right, clear "got flag", else, untuched
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F9   12A5           00402     bcf     rc_listen,5
                      00403 
00FA   30D0           00404         movlw   rcframe+6           ;; Move recived byte to W
00FB   1283 1303      00405         banksel FSR
00FD   0084           00406     movwf       FSR
                      00407 
00FE                  00408 recend_tmp:
00FE   1283 1303      00409     banksel speedlib_main
0100   18F5           00410     btfsc   speedlib_main,1     ;; No CUSTOM command when in Whait for RESP STATE
0101   2???           00411     goto    recend_no_broadcast
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0102   2???           00412         goto    func_bc
                      00413 
0103                  00414 recend_no_broadcast:
0103   1683 1303      00415     banksel rcframe
0105   30CA           00416         movlw   rcframe
0106   0084           00417         movwf   FSR
0107   1383           00418     bankisel rcframe
0108   0800           00419         movf    INDF,W              ;; Check so that the adress is destinated for me
0109   1683 1303      00420         banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
010B   022B           00421     subwf       adress1,W
010C   1D03           00422         btfss   STATUS,Z
010D   2???           00423         goto    restore
010E   0A04           00424         incf    FSR,W
010F   0084           00425         movwf   FSR
0110   1383           00426     bankisel rcframe
0111   0800           00427         movf    INDF,W
0112   1683 1303      00428     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0114   022C           00429         subwf   adress2,W
0115   1D03           00430         btfss   STATUS,Z
0116   2???           00431         goto    restore
                      00432 
0117   30D0           00433         movlw   rcframe+6           ;; Move recived byte to W
0118   0084           00434     movwf       FSR
                      00435 
0119   3000           00436         movlw   0x00                ;; Got response
011A   1383           00437         bankisel rcframe
011B   0200           00438     subwf       INDF,W
011C   1903           00439         btfsc   STATUS,Z
011D   2???           00440         goto    func_check_response
                      00441 
011E   1283 1303      00442     banksel speedlib_main
0120   18F5           00443     btfsc   speedlib_main,1     ;; No CUSTOM command when in Whait for RESP STATE
0121   2???           00444     goto    restore
                      00445 
0122   1683 1303      00446     banksel rcframe+5
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0124   084F           00447         movf    rcframe+5,W
0125   3C01           00448         sublw   0x01
0126   1903           00449         btfsc   STATUS,Z
0127   2???           00450     call    func_send_response
                      00451 
                      00452 
                      00453         
0128   30D0           00454         movlw   rcframe+6           ;; Make sure that the FSR pointer is pointed right
0129   0084           00455     movwf       FSR
                      00456 
012A   3001           00457         movlw   0x01                ;; Send respons for, 0x01 message, destionated for me
012B   1383           00458         bankisel rcframe
012C   0200           00459     subwf       INDF,W
012D   1903           00460         btfsc   STATUS,Z
012E   2???           00461         goto    func_is_ocupied_send_response
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00462         
012F   3002           00463         movlw   0x02
0130   1383           00464     bankisel rcframe
0131   0200           00465         subwf   INDF,W
0132   1903           00466         btfsc   STATUS,Z
0133   2???           00467         goto    func_setport
                      00468 
                      00469 #ifdef  REC_SPB_PARAMETERS
0134   3004           00470         movlw   0x04
0135   1383           00471     bankisel rcframe
0136   0200           00472         subwf   INDF,W
0137   1903           00473         btfsc   STATUS,Z
0138   2???           00474     goto    REC_SPB_PARAMETERS
                      00475 #endif
                      00476 
                      00477 #ifdef  REC_CUSTOM_JUMP
0139   2???           00478     goto    REC_CUSTOM_JUMP
                      00479 #endif
013A   2???           00480         goto    restore
                      00481 
013B                  00482 func_speedlib_config:
013B   300D           00483         movlw   13
013C   1683 1303      00484     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013E   0226           00485         subwf   rc_counter,W
013F   1903           00486         btfsc   STATUS,Z
0140   2???           00487         goto    func_speedlib_config_basics
                      00488 
0141   1803           00489     btfsc   STATUS,C
0142   2???           00490     goto    func_speedlib_config_extended
0143   2???           00491     goto    restore
                      00492 
                      00493 
0144                  00494 func_speedlib_config_extended:
0144   30D5           00495     movlw       rcframe+11           ;; Make sure that the FSR pointer is pointed right
0145   0084           00496     movwf       FSR
0146   3000           00497     movlw       0x00
0147   1383           00498     bankisel rcframe
0148   0200           00499         subwf   INDF,W
0149   1903           00500         btfsc   STATUS,Z
014A   2???           00501         goto    func_speedlib_config_basics
014B   3001           00502         movlw   0x01
014C   1383           00503     bankisel rcframe
014D   0200           00504         subwf   INDF,W
014E   1903           00505         btfsc   STATUS,Z
014F   2???           00506         goto    func_speedlib_config_caddr
0150   2???           00507     goto    restore
                      00508 
                      00509 
0151                  00510 func_speedlib_config_caddr:
0151   3010           00511     movlw       16
0152   1683 1303      00512     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0154   0226           00513         subwf   rc_counter,W
0155   1C03           00514         btfss   STATUS,C            ;; If rc_counter NOT is more och equal to twelve, jump back
0156   2???           00515     goto    restore
                      00516 
                      00517     ;;call    func_send_response
                      00518         
0157   30D6           00519     movlw       rcframe+12           ;; Move recived byte to W
0158   0084           00520         movwf   FSR
0159   30FF           00521     movlw   0xFF
015A   1383           00522     bankisel rcframe
015B   0200           00523     subwf   INDF,W
015C   1D03           00524     btfss   STATUS,Z
015D   2???           00525     goto    func_speedlib_config_caddr_f
015E   1283 1303      00526     banksel FSR
0160   0A84           00527     incf    FSR,F
0161   30FF           00528     movlw   0xFF
0162   1383           00529     bankisel rcframe
0163   0200           00530     subwf   INDF,W
0164   1D03           00531     btfss   STATUS,Z
0165   2???           00532     goto    func_speedlib_config_caddr_f
0166   2???           00533     goto    restore
                      00534 
0167                  00535 func_speedlib_config_caddr_f:
0167   30D6           00536     movlw       rcframe+12      ; Move recived byte to W
0168   0084           00537         movwf   FSR
0169   1383           00538     bankisel rcframe
016A   0800           00539     movf    INDF,W
016B   1683 1303      00540     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016D   00AB           00541     movwf   adress1
016E   0A84           00542     incf    FSR, F
016F   1383           00543     bankisel rcframe
0170   0800           00544     movf    INDF,W
0171   1683 1303      00545     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0173   00AC           00546     movwf   adress2
                      00547 
0174   1683 1303      00548     banksel speedlib_config
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0176   14AD           00549     bsf     speedlib_config,1
                      00550 #ifdef  WRITE_EEPROM
                      00551     ;; Write adress to eeprom
0177   3000           00552     movlw   0
0178   1683 1303      00553     banksel rc_nocoll
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017A   00A7           00554     movwf   rc_nocoll
017B   1683 1303      00555     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017D   082B           00556     movf    adress1,W
017E   2???           00557     call    WRITE_EEPROM
017F   1683 1303      00558     banksel rc_nocoll
0181   3001           00559     movlw   1
0182   1683 1303      00560     banksel rc_nocoll
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0184   00A7           00561     movwf   rc_nocoll
0185   1683 1303      00562     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0187   082C           00563     movf    adress2,W
0188   2???           00564     call    WRITE_EEPROM
0189   1683 1303      00565     banksel rc_nocoll
018B   3002           00566     movlw   2
018C   1683 1303      00567     banksel rc_nocoll
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
018E   00A7           00568     movwf   rc_nocoll
018F   1683 1303      00569     banksel speedlib_config
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0191   082D           00570     movf    speedlib_config,W
0192   2???           00571     call    WRITE_EEPROM
                      00572 #endif
                      00573     ;; Delay to make sure there is no error on the bus
0193   300C           00574     movlw   12
0194   2???           00575     call    Delay
0195   2???           00576     call    func_bc_sendaddr_noresp
                      00577     ;;
0196   2???           00578     goto    restore
                      00579 
                      00580 
0197                  00581 func_speedlib_config_basics:
0197   300C           00582     movlw   12
0198   2???           00583     call    Delay
0199   300B           00584         movlw   11
019A   1683 1303      00585     banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
019C   00B2           00586         movwf   framelen
                      00587 
019D   30CC           00588     movlw       rcframe+2
019E   0084           00589     movwf       FSR
019F   1383           00590     bankisel rcframe
01A0   0800           00591     movf    INDF,W
01A1   1683 1303      00592     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A3   00B5           00593         movwf   txframe
                      00594 
01A4   30CD           00595     movlw       rcframe+3
01A5   0084           00596     movwf       FSR
01A6   1383           00597     bankisel rcframe
01A7   0800           00598     movf    INDF,W
01A8   1683 1303      00599     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01AA   00B6           00600         movwf   txframe+1
                      00601 
                      00602     ;; * my own src adress
01AB   1683 1303      00603     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01AD   082B           00604         movf    adress1, W
01AE   1683 1303      00605     banksel txframe+2
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B0   00B7           00606         movwf   txframe+2
                      00607 
                      00608     ;; * my own src adress
01B1   1683 1303      00609     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B3   082C           00610         movf    adress2, W
01B4   1683 1303      00611     banksel txframe+3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B6   00B8           00612         movwf   txframe+3
                      00613 
                      00614     ;; 0x03 control bit
01B7   3003           00615         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B8   00B9           00616         movwf   txframe+4
                      00617 
                      00618     ;; 0x01     protocoll
01B9   3000           00619     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01BA   00BA           00620         movwf   txframe+5
                      00621 
                      00622     ;; Data
01BB   3003           00623     movlw       0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01BC   00BB           00624         movwf   txframe+6
                      00625 
                      00626     ;; 0x00 Basic config response
01BD   3000           00627         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01BE   00BC           00628     movwf   txframe+7
                      00629 
                      00630     ;; Send back speedlib_config
01BF   1683 1303      00631     banksel speedlib_config
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C1   082D           00632         movf   speedlib_config, W
01C2   1683 1303      00633     banksel txframe+8
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C4   00BD           00634     movwf   txframe+8
                      00635 
                      00636     ;; Padding bit
01C5   3000           00637         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C6   00BE           00638     movwf   txframe+9
                      00639 
01C7   2???           00640     call    txdo
01C8   2???           00641     goto    restore
                      00642 
01C9                  00643 func_send_response:
01C9   3009           00644     movlw   SPEEDLIB_RESPONSE_DELAY
01CA   2???           00645     call    Delay
01CB   3009           00646         movlw   9
01CC   1683 1303      00647     banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01CE   00B2           00648         movwf   framelen
                      00649 
01CF   30CC           00650     movlw       rcframe+2
01D0   0084           00651     movwf       FSR
01D1   1383           00652     bankisel rcframe
01D2   0800           00653     movf    INDF,W
01D3   1683 1303      00654     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01D5   00B5           00655         movwf   txframe
                      00656 
01D6   30CD           00657     movlw       rcframe+3
01D7   0084           00658     movwf       FSR
01D8   1383           00659     bankisel rcframe
01D9   0800           00660     movf    INDF,W
01DA   1683 1303      00661     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DC   00B6           00662         movwf   txframe+1
                      00663 
                      00664         ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DD   082B           00665         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DE   00B7           00666         movwf   txframe+2
                      00667 
                      00668         ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DF   082C           00669         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E0   00B8           00670         movwf   txframe+3
                      00671 
                      00672         ;; 0x03 control bit
01E1   3003           00673         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E2   00B9           00674         movwf   txframe+4
                      00675 
                      00676         ;; 0x01 protocoll
01E3   3000           00677     movlw   0x00                ;; No response on response
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E4   00BA           00678         movwf   txframe+5   
                      00679 
                      00680         ;; Data             
01E5   3000           00681     movlw       0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E6   00BB           00682         movwf   txframe+6
                      00683 
                      00684         ;; Padding bit
01E7   3000           00685         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E8   00BC           00686     movwf   txframe+7
                      00687 
01E9   2???           00688         call    txdo
01EA   0008           00689     return
                      00690 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01EB                  00691 func_check_response:
                      00692 ; May be more advanced in the future, but for now, i dont se any reason why
                      00693 ; we should make this functione more advanced, how many response packages are
                      00694 ; realy exchange in a cuple of ms? -.- //  Speedster
01EB   1683 1303      00695     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01ED   15A5           00696     bsf     rc_listen,3
01EE   2???           00697     goto        restore
                      00698 
                      00699 
01EF                  00700 func_is_ocupied_send_response:
01EF   300C           00701         movlw   12                  ;; Pretty strange, but you need this, so no colission or somthing wi
                            ll be made betwen PC and ansoring device
01F0   2???           00702         call    Delay
                      00703 
01F1   1683 1303      00704     banksel rc_listen
                      00705         ;; Send Package:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01F3   1825           00706     btfsc   rc_listen,0
01F4   2???           00707     goto    func_is_ocupied_send_response_got_resp
01F5   2???           00708     goto    func_is_ocupied_send_response_pack
Warning[208]: Label truncated at 32 characters. (func_is_ocupied_send_response_got_resp)
01F6                  00709 func_is_ocupied_send_response_got_resp:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01F6   1025           00710     bcf     rc_listen,0
01F7   2???           00711     goto    restore
                      00712 
Warning[208]: Label truncated at 32 characters. (func_is_ocupied_send_response_pack)
01F8                  00713 func_is_ocupied_send_response_pack:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01F8   1A25           00714     btfsc   rc_listen,4
01F9   2???           00715     goto    restore
01FA   3009           00716         movlw   9
01FB   1683 1303      00717     banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01FD   00B2           00718         movwf   framelen
                      00719 
01FE   30CC           00720         movlw   rcframe+2
01FF   0084           00721     movwf       FSR
0200   1383           00722     bankisel rcframe
0201   0800           00723     movf    INDF,W
0202   1683 1303      00724     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0204   00B5           00725         movwf   txframe
                      00726 
0205   30CD           00727         movlw   rcframe+3
0206   0084           00728         movwf   FSR
0207   1383           00729     bankisel rcframe
0208   0800           00730     movf    INDF,W
0209   1683 1303      00731     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
020B   00B6           00732         movwf   txframe+1
                      00733 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00734         ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
020C   082B           00735         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
020D   00B7           00736         movwf   txframe+2
                      00737 
                      00738         ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
020E   082C           00739         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
020F   00B8           00740         movwf   txframe+3
                      00741 
                      00742         ;; 0x03 control bit
0210   3003           00743         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0211   00B9           00744         movwf   txframe+4
                      00745 
                      00746         ;; 0x01 protocoll
0212   3000           00747     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0213   00BA           00748         movwf   txframe+5
                      00749 
                      00750         ;; Data
0214   3001           00751     movlw       0x01
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0215   00BB           00752         movwf   txframe+6
                      00753 
                      00754         ;; Padding bit
0216   3000           00755         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0217   00BC           00756     movwf   txframe+7
                      00757 
0218   2???           00758         call    txdo    
                      00759 
0219   2???           00760         goto    restore
                      00761 
                      00762         
021A                  00763 func_bc:
                      00764 ; 120623 A new era has become speedbus, all package that are need to, shall for
                      00765 ; now be sent with an respons, and, for that reason, i no more use command 0x00
                      00766 ; for is_occupied commands. When an 0x01 NOT is broadcast(it got a real adress)
                      00767 ; It is ment to bee like an old 0x00, if it is not an bc, send is_occupied.
                      00768 ; For now on, 0x00 is used to respond packages that need a response! Over'n out
                      00769 ; // Speedster
                      00770 
021A   1683 1303      00771     banksel rcframe
021C   30CA           00772         movlw   rcframe
021D   0084           00773     movwf       FSR
                      00774         
021E   30FF           00775         movlw   0xFF                ;;  check dst adress1
021F   1683 1303      00776         banksel rcframe
0221   0200           00777     subwf       INDF,W
0222   1D03           00778         btfss   STATUS,Z
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0223   2???           00779         goto    recend_no_broadcast
                      00780 
0224   0A84           00781         incf    FSR, F               ;; Increase the address
                      00782 
0225   30FF           00783         movlw   0xFF                ;;  check dst adress2
0226   1683 1303      00784         banksel rcframe
0228   0200           00785     subwf       INDF,W
0229   1D03           00786         btfss   STATUS,Z
022A   2???           00787         goto    recend_no_broadcast
                      00788 
022B   30D0           00789         movlw   rcframe+6        
022C   0084           00790     movwf       FSR
                      00791 
                      00792 #ifdef  on_got_IAH
                      00793     movlw       0x03
                      00794     bankisel rcframe
                      00795         subwf   INDF,W
                      00796         btfss   STATUS,Z
                      00797         goto    restore
                      00798     bankisel rcframe
                      00799     incf    FSR, F
                      00800     movlw       0x01
                      00801     bankisel rcframe
                      00802         subwf   INDF,W
                      00803         btfss   STATUS,Z
                      00804         goto    restore
                      00805     goto    on_got_IAH
                      00806 #endif
                      00807 
022D   300C           00808     movlw   12
022E   1683 1303      00809     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0230   0226           00810     subwf   rc_counter, W
0231   1803           00811     btfsc   STATUS, C
0232   2???           00812     goto    func_bc_devid
                      00813 
0233   3001           00814         movlw   0x01
0234   1383           00815     bankisel rcframe
0235   0200           00816         subwf   INDF,W
0236   1903           00817         btfsc   STATUS,Z
0237   2???           00818         goto    func_bc_01
0238   2???           00819         goto    restore
                      00820 
                      00821 
0239                  00822 func_bc_devid:
                      00823     ;; Check that the devid matches, else drop it.
                      00824 
                      00825 
0239   30D1           00826         movlw   rcframe+7
023A   0084           00827     movwf       FSR
023B   1383           00828     bankisel rcframe
023C   3000           00829     movlw   DEV_ID1
023D   0200           00830     subwf   INDF, W
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

023E   1D03           00831     btfss   STATUS, Z
023F   2???           00832     goto    restore
                      00833 
0240   30D2           00834         movlw   rcframe+8
0241   0084           00835     movwf       FSR
0242   1383           00836     bankisel rcframe
0243   3000           00837     movlw   DEV_ID2
0244   0200           00838     subwf   INDF, W
0245   1D03           00839     btfss   STATUS, Z
0246   2???           00840     goto    restore
                      00841 
0247   30D3           00842         movlw   rcframe+9
0248   0084           00843     movwf       FSR
0249   1383           00844     bankisel rcframe
024A   3000           00845     movlw   DEV_ID3
024B   0200           00846     subwf   INDF, W
024C   1D03           00847     btfss   STATUS, Z
024D   2???           00848     goto    restore
                      00849 
024E   30D4           00850         movlw   rcframe+10
024F   0084           00851     movwf       FSR
0250   1383           00852     bankisel rcframe
0251   30C8           00853     movlw   DEV_ID4
0252   0200           00854     subwf   INDF, W
0253   1D03           00855     btfss   STATUS, Z
0254   2???           00856     goto    restore
                      00857 
                      00858 
                      00859     ;;
0255   30D0           00860         movlw   rcframe+6
0256   0084           00861     movwf   FSR
0257   1383           00862     bankisel rcframe
0258   3001           00863     movlw       0x01
0259   0200           00864         subwf   INDF,W
025A   1903           00865         btfsc   STATUS,Z
025B   2???           00866         goto    func_bc_sendaddr_devid_resp
025C   1383           00867     bankisel rcframe
025D   3003           00868     movlw       0x03
025E   0200           00869         subwf   INDF,W
025F   1903           00870         btfsc   STATUS,Z
0260   2???           00871         goto    func_speedlib_config
0261   2???           00872     goto    restore
                      00873 
0262                  00874 func_bc_sendaddr_devid_resp:
0262   300C           00875     movlw   12
0263   2???           00876     call    Delay
0264   2???           00877     call    func_bc_sendaddr_noresp
0265   2???           00878     goto    restore
                      00879 
0266                  00880 func_bc_01:
0266   30CF           00881     movlw       rcframe+5
0267   0084           00882     movwf       FSR
0268   3001           00883         movlw   0x01
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0269   1383           00884     bankisel rcframe
026A   0200           00885         subwf   INDF,W
026B   1903           00886         btfsc   STATUS,Z
026C   2???           00887     goto    func_bc_sendaddr
026D   3000           00888     movlw       0x00
026E   1383           00889     bankisel rcframe
026F   0200           00890     subwf       INDF,W
0270   1903           00891         btfsc   STATUS,Z
0271   2???           00892     call    func_send_response
0272   2???           00893     goto    restore
                      00894 
0273                  00895 func_bc_sendaddr:       
0273   2???           00896         call    trd                 ;; Three random delay:s before ansor broadcast
0274   300C           00897     movlw   12
0275   2???           00898     call    Delay
0276   2???           00899     call    func_set_rsp_addr   ;; Set rsp_adress to the src adress of the last recived package
                      00900 
                      00901         ;; Send Package:
0277   300D           00902         movlw   13
0278   1683 1303      00903         banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
027A   00B2           00904         movwf   framelen
                      00905 
                      00906         ;; dst adress
027B   1683 1303      00907     banksel rsp_adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
027D   0829           00908         movf    rsp_adress1,W
027E   1683 1303      00909     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0280   00B5           00910         movwf   txframe
                      00911 
                      00912         ;; dst adress
0281   1683 1303      00913     banksel rsp_adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0283   082A           00914         movf    rsp_adress2,W
0284   1683 1303      00915     banksel txframe+1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0286   00B6           00916         movwf   txframe+1
                      00917 
                      00918         ;; * my own src adress
0287   1683 1303      00919     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0289   082B           00920         movf    adress1, W
028A   1683 1303      00921     banksel txframe+2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
028C   00B7           00922         movwf   txframe+2
                      00923 
                      00924         ;; * my own src adress
028D   1683 1303      00925     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
028F   082C           00926         movf    adress2, W
0290   1683 1303      00927     banksel txframe+3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0292   00B8           00928         movwf   txframe+3
                      00929 
                      00930         ;; 0x03 control bit
0293   3003           00931         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0294   00B9           00932         movwf   txframe+4
                      00933 
                      00934         ;; 0x01 protocoll
0295   3001           00935     movlw   0x01
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0296   00BA           00936         movwf   txframe+5
                      00937 
                      00938         ;; Data
0297   3001           00939     movlw       0x01
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0298   00BB           00940         movwf   txframe+6
                      00941 
                      00942     ;; Data - DeviceID
0299   3000           00943     movlw   DEV_ID1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
029A   00BC           00944         movwf   txframe+7
                      00945 
                      00946         ;; Data - DeviceID
029B   3000           00947     movlw       DEV_ID2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
029C   00BD           00948         movwf   txframe+8
                      00949 
                      00950    ;; Data - DeviceID
029D   3000           00951     movlw   DEV_ID3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
029E   00BE           00952         movwf   txframe+9
                      00953 
                      00954         ;; Data - DeviceID
029F   30C8           00955     movlw       DEV_ID4
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02A0   00BF           00956         movwf   txframe+10
                      00957 
                      00958         ;; Padding bit
02A1   3000           00959         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02A2   00C0           00960     movwf   txframe+11
                      00961         
                      00962         ;; This is a broadcast package with adress on it
02A3   3001           00963         movlw   0x01
02A4   1683 1303      00964     banksel rcframe+5
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02A6   024F           00965         subwf   rcframe+5,W
02A7   1903           00966         btfsc   STATUS,Z
02A8   2???           00967     goto    handle_response
02A9   2???           00968     call    txdo
02AA   2???           00969         goto    restore
                      00970 
02AB                  00971 func_bc_sendaddr_noresp:
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02AB   2???           00972     call    func_set_rsp_addr   ;; Set rsp_adress to the src adress of the last recived package
                      00973 
                      00974         ;; Send Package:
02AC   300D           00975         movlw   13
02AD   1683 1303      00976         banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02AF   00B2           00977         movwf   framelen
                      00978 
                      00979         ;; dst adress
02B0   1683 1303      00980     banksel rsp_adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02B2   0829           00981         movf    rsp_adress1,W
02B3   1683 1303      00982     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02B5   00B5           00983         movwf   txframe
                      00984 
                      00985         ;; dst adress
02B6   1683 1303      00986     banksel rsp_adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02B8   082A           00987         movf    rsp_adress2,W
02B9   1683 1303      00988     banksel txframe+1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02BB   00B6           00989         movwf   txframe+1
                      00990 
                      00991         ;; * my own src adress
02BC   1683 1303      00992     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02BE   082B           00993         movf    adress1, W
02BF   1683 1303      00994     banksel txframe+2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C1   00B7           00995         movwf   txframe+2
                      00996 
                      00997         ;; * my own src adress
02C2   1683 1303      00998     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C4   082C           00999         movf    adress2, W
02C5   1683 1303      01000     banksel txframe+3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C7   00B8           01001         movwf   txframe+3
                      01002 
                      01003         ;; 0x03 control bit
02C8   3003           01004         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C9   00B9           01005         movwf   txframe+4
                      01006 
                      01007         ;; 0x01 protocoll
02CA   3000           01008     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02CB   00BA           01009         movwf   txframe+5
                      01010 
                      01011         ;; Data
02CC   3001           01012     movlw       0x01
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02CD   00BB           01013         movwf   txframe+6
                      01014 
                      01015     ;; Data - DeviceID
02CE   3000           01016     movlw   DEV_ID1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02CF   00BC           01017         movwf   txframe+7
                      01018 
                      01019         ;; Data - DeviceID
02D0   3000           01020     movlw       DEV_ID2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02D1   00BD           01021         movwf   txframe+8
                      01022 
                      01023    ;; Data - DeviceID
02D2   3000           01024     movlw   DEV_ID3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02D3   00BE           01025         movwf   txframe+9
                      01026 
                      01027         ;; Data - DeviceID
02D4   30C8           01028     movlw       DEV_ID4
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02D5   00BF           01029         movwf   txframe+10
                      01030 
                      01031         ;; Padding bit
02D6   3000           01032         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02D7   00C0           01033     movwf   txframe+11
02D8   2???           01034         call    txdo
02D9   0008           01035     return
                      01036 
02DA                  01037 func_send_iam_here:             ;; IMPORTANT, this function "return", use "call func_send_iam_here"
02DA   300E           01038         movlw   14
02DB   1683 1303      01039     banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02DD   00B2           01040         movwf   framelen
                      01041 
02DE   1683 1303      01042     banksel txframe
02E0   30FF           01043     movlw   0xFF
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E1   00B5           01044         movwf   txframe
                      01045 
02E2   30FF           01046     movlw   0xFF
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E3   00B6           01047         movwf   txframe+1
                      01048 
                      01049     ;; * my own src adress
02E4   1683 1303      01050     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E6   082B           01051         movf    adress1, W
02E7   1683 1303      01052     banksel txframe+2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E9   00B7           01053         movwf   txframe+2
                      01054 
                      01055     ;; * my own src adress
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02EA   1683 1303      01056     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02EC   082C           01057         movf    adress2, W
02ED   1683 1303      01058     banksel txframe+3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02EF   00B8           01059         movwf   txframe+3
                      01060 
                      01061     ;; 0x03 control bit
02F0   3003           01062         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F1   00B9           01063         movwf   txframe+4
                      01064 
                      01065     ;; 0x01     protocoll
02F2   3000           01066     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F3   00BA           01067         movwf   txframe+5
                      01068 
                      01069     ;; Data
02F4   3003           01070     movlw       0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F5   00BB           01071         movwf   txframe+6
                      01072 
                      01073     ;; 0x00 Basic config response
02F6   3001           01074         movlw   0x01
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F7   00BC           01075     movwf   txframe+7
                      01076 
                      01077     ;; Data - DeviceID
02F8   3000           01078     movlw   DEV_ID1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F9   00BD           01079         movwf   txframe+8
                      01080 
                      01081     ;; Data - DeviceID
02FA   3000           01082     movlw       DEV_ID2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02FB   00BE           01083         movwf   txframe+9
                      01084 
                      01085     ;; Data - DeviceID
02FC   3000           01086     movlw   DEV_ID3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02FD   00BF           01087         movwf   txframe+10
                      01088 
                      01089     ;; Data - DeviceID
02FE   30C8           01090     movlw       DEV_ID4
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02FF   00C0           01091         movwf   txframe+11
                      01092 
                      01093         ;; Padding bit
0300   3000           01094         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0301   00C1           01095     movwf   txframe+12
                      01096 
0302   2???           01097     call    txdo
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0303   0008           01098     return  
                      01099 
0304                  01100 func_rand_addr:
0304   1683 1303      01101     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0306   0824           01102     movf    rand,W
0307   1683 1303      01103     banksel adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0309   00AB           01104     movwf   adress1
030A   2???           01105     call    lfsr_func
030B   1683 1303      01106     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
030D   0824           01107     movf    rand,W
030E   1683 1303      01108     banksel adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0310   00AC           01109     movwf   adress2
0311   0008           01110     return
                      01111 
0312                  01112 func_setport:
0312   3002           01113         movlw   2
0313   0784           01114         addwf   FSR,F
0314   1383           01115     bankisel rcframe
0315   0800           01116         movf    INDF,W
                      01117 #ifdef PORTC
0316   1283 1303      01118     banksel PORTC
0318   0087           01119         movwf   PORTC
                      01120 #endif
0319   2???           01121         goto    restore
                      01122 
031A                  01123 func_set_rsp_addr:
                      01124     ;; Add last rec package src addr to rsp_adress1 rsp_adress2
031A   30CC           01125     movlw       rcframe+2
031B   0084           01126         movwf   FSR
031C   1383           01127     bankisel rcframe
031D   0800           01128     movf    INDF,W
031E   1683 1303      01129     banksel rsp_adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0320   00A9           01130     movwf   rsp_adress1
                      01131 
0321   30CD           01132         movlw   rcframe+3
0322   0084           01133         movwf   FSR
0323   1383           01134     bankisel rcframe
0324   0800           01135     movf    INDF,W
0325   1683 1303      01136     banksel rsp_adress2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0327   00AA           01137     movwf   rsp_adress2
0328   0008           01138     return
                      01139 
0329                  01140 handle_response:
0329   1683 1303      01141     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
032B   11A5           01142     bcf     rc_listen,3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

032C   10A5           01143     bcf     rc_listen,1
032D   14F5           01144     bsf     speedlib_main,1
                      01145 
                      01146 
                      01147     ;; Important, this should be run in "main space", not interupt space, soo,
                      01148     ;; well, now it is runed somewheare in the middle, wait for response STATE
032E   1283 1303      01149     banksel INTCON
0330   178B           01150     bsf     INTCON,GIE
0331   300A           01151     movlw   10
0332   1683 1303      01152     banksel rsp_adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0334   00A9           01153     movwf   rsp_adress1
                      01154 
0335                  01155 handle_response_loop:
0335   2???           01156     call    txdo
0336   30FA           01157         movlw   250
0337   2???           01158         call    Delay
                      01159 
                      01160     ;; If error
0338   1283 1303      01161     banksel RCSTA
033A   1898           01162         btfsc   RCSTA,OERR
033B   2???           01163         call    recerror
                      01164     ;;
                      01165 
033C   1683 1303      01166     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
033E   19A5           01167     btfsc   rc_listen,3
033F   2???           01168     goto    handle_response_ret
0340   1683 1303      01169     banksel rsp_adress1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0342   0BA9           01170     decfsz  rsp_adress1,f
0343   2???           01171     goto    handle_response_loop
                      01172 
0344                  01173 handle_response_ret:
0344   1683 1303      01174     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0346   11A5           01175     bcf     rc_listen,3
0347   10F5           01176     bcf     speedlib_main,1
0348   2???           01177     goto    restore
                      01178 
0349                  01179 reccrcfail:
                      01180         ;; Because that this happend directrly after a crc-fail, here we need to clear the counter, so t
                            he next comming package will start allover
0349   3005           01181     movlw   5
034A   1683 1303      01182     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
034C   0226           01183     subwf   rc_counter,W
034D   1C03           01184     btfss   STATUS,C
034E   2???           01185     goto    reccrcfail_end
                      01186 
034F   30FA           01187     movlw    250
0350   2???           01188     call    Delay
                      01189 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0351                  01190 reccrcfail_end:
0351   1683 1303      01191     banksel rc_counter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0353   01A6           01192     clrf        rc_counter
0354   2???           01193         goto    restore
                      01194         
0355                  01195 recerror:
                      01196         ;; Do somthing
0355   1283 1303      01197     banksel RCSTA
0357   1218           01198         bcf     RCSTA,CREN
0358   1618           01199         bsf     RCSTA,CREN
0359   0008           01200         return
                      01201 
035A                  01202 txoops:
                      01203     ;; Colisson has ocurred
035A   1683 1303      01204     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
035C   10A5           01205     bcf     rc_listen,1
035D   1683 1303      01206     banksel txreturn
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
035F   10B4           01207         bcf     txreturn,1
0360   2???           01208         call    lfsr_func
0361   1683 1303      01209     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0363   0824           01210         movf    rand,W
0364   2???           01211         call    Delay
0365   2???           01212         goto    txdo2
                      01213 
0366                  01214 tx_send:
0366   1683 1303      01215     banksel txtmp
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0368   00B3           01216         movwf   txtmp
0369   307E           01217         movlw   0x7e            
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
036A   0233           01218         subwf   txtmp,W         
036B   1903           01219         btfsc   STATUS,Z
036C   2???           01220         goto    tx_send_escape_1
                      01221 
036D   307D           01222         movlw   0x7d
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
036E   0233           01223         subwf   txtmp,W
036F   1903           01224         btfsc   STATUS,Z
0370   2???           01225         goto    tx_send_escape_2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0371   0833           01226         movf    txtmp,W
                      01227         
0372                  01228 tx_send_noescape:
0372   1683 1303      01229     banksel txtmp
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0374   00B3           01230     movwf       txtmp
                      01231 
0375   1683 1303      01232     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0377   14A5           01233     bsf     rc_listen,1
                      01234 
0378   1683 1303      01235     banksel txtmp
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
037A   0833           01236     movf        txtmp,W
037B   1683 1303      01237     banksel rc_nocoll
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
037D   00A7           01238     movwf       rc_nocoll
037E   1283 1303      01239     banksel TXREG
0380   0099           01240     movwf       TXREG
                      01241 
0381   1683 1303      01242     banksel TXSTA
0383                  01243 tx_send_noescape_l:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0383   1C98           01244     btfss   TXSTA,TRMT
0384   2???           01245     goto        tx_send_noescape_l
                      01246 
0385   1683 1303      01247     banksel d1
0387   3090           01248     movlw   0x90
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0388   00A0           01249     movwf   d1
0389                  01250 tx_send_noescape_k:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0389   0BA0           01251     decfsz  d1,f
038A   2???           01252     goto    tx_send_noescape_k
038B   0008           01253         return
                      01254 
038C                  01255 tx_send_escape_1:
038C   307D           01256         movlw   0x7d
038D   2???           01257         call    tx_send_noescape
038E   305E           01258         movlw   0x5e
038F   2???           01259         call    tx_send_noescape
0390   0008           01260         return
                      01261 
0391                  01262 tx_send_escape_2:
0391   307D           01263         movlw   0x7d
0392   2???           01264         call    tx_send_noescape
0393   305D           01265         movlw   0x5d
0394   2???           01266         call    tx_send_noescape
0395   0008           01267         return
                      01268         
0396                  01269 txdo:                           
                      01270     ;; This is like the function argumnents, they need to be set at every presense of crcloopr
0396   1683 1303      01271     banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0398   0832           01272         movf    framelen,W
0399   1683 1303      01273     banksel crcloop
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
039B   00B0           01274         movwf   crcloop
039C   1683 1303      01275     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
039E   14A5           01276     bsf     rc_listen,1
039F   30B5           01277         movlw   txframe
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03A0   0084           01278         movwf   FSR
03A1   1683 1303      01279     banksel crc0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03A3   01AE           01280         clrf    crc0
03A4   1683 1303      01281     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03A6   01AF           01282         clrf    crc1
03A7   2???           01283         call    crcloopr
03A8   2???           01284         goto    txdo2
03A9                  01285 crcloopr:
03A9   1683 1303      01286     banksel crcloop
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03AB   0BB0           01287         decfsz  crcloop, f
03AC   2???           01288         goto    crccalc
03AD   0008           01289         return
                      01290 
03AE                  01291 crccalc:
03AE   1383           01292     bankisel txframe
03AF   0800           01293         movf    INDF,W              ;; Load W with next databyte
03B0   1683 1303      01294     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03B2   062F           01295         xorwf   crc1,W              ;;(a^x):(b^y)
03B3   1683 1303      01296     banksel crctmp
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03B5   00B1           01297         movwf   crctmp              ;;
03B6   39F0           01298         andlw   0xf0                ;; W = (a^x):0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03B7   0EB1           01299         swapf   crctmp,F            ;; Index = (b^y):(a^x)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03B8   06B1           01300         xorwf   crctmp,F            ;; Index = (a^b^x^y):(a^x) = i2:i1
                      01301 
                      01302                                 ;; High byte
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03B9   0831           01303         movf    crctmp,W
03BA   39F0           01304         andlw   0xf0
03BB   1683 1303      01305     banksel crc0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03BD   062E           01306         xorwf   crc0,W
03BE   1683 1303      01307     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03C0   00AF           01308         movwf   crc1
03C1   1683 1303      01309     banksel crctmp
                      01310 #ifdef  ARC_18F
                      01311     rlcf    crctmp,W            ;; use rlf for PIC18
                      01312         rlcf    crctmp,W            ;; use rlf for PIC18
                      01313 #endif
                      01314 #ifdef  ARC_16F
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03C3   0D31           01315         rlf     crctmp,W            ;; use rlf for PIC16
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03C4   0D31           01316         rlf     crctmp,W            ;; use rlf for PIC16
                      01317 #endif
                      01318 #ifdef  ARC_12F
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01319         rlf     crctmp,W            ;; use rlf for PIC12
                      01320         rlf     crctmp,W            ;; use rlf for PIC12
                      01321 #endif
03C5   1683 1303      01322     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03C7   06AF           01323         xorwf   crc1,F
03C8   39E0           01324         andlw   0xe0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03C9   06AF           01325         xorwf   crc1,F
                      01326 
03CA   1683 1303      01327     banksel crctmp
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03CC   0EB1           01328         swapf   crctmp,F
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03CD   0631           01329         xorwf   crctmp,W
03CE   1683 1303      01330     banksel crc0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03D0   00AE           01331         movwf   crc0
03D1   0A84           01332     incf    FSR, F
03D2   2???           01333         goto    crcloopr
                      01334 
03D3                  01335 txdo2:
                      01336     ;; Set TX enable
03D3   1283 1303      01337     banksel OUTREG
03D5   1606           01338         bsf     OUTREG,OUTNUM
                      01339         ;;
03D6   1683 1303      01340     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03D8   14A5           01341     bsf     rc_listen,1
03D9   307E           01342         movlw   0x7e
03DA   2???           01343         call    tx_send_noescape
03DB   30B5           01344     movlw       txframe
03DC   0084           01345         movwf   FSR
03DD   1683 1303      01346     banksel framelen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03DF   0832           01347         movf    framelen,W
03E0   1683 1303      01348     banksel crcloop
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03E2   00B0           01349         movwf   crcloop
03E3                  01350 send:
03E3   1683 1303      01351     banksel crcloop
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03E5   0BB0           01352         decfsz  crcloop,f
03E6   2???           01353         goto    lopp
03E7   2???           01354         goto    crcsend
03E8                  01355 lopp:
03E8   1383           01356     bankisel txframe
03E9   0800           01357         movf    INDF,W
03EA   2???           01358         call    tx_send
03EB   0A84           01359         incf    FSR,F
03EC   2???           01360         goto    send
                      01361 
03ED                  01362 crcsend:
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03ED   1683 1303      01363     banksel crc0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03EF   082E           01364         movf    crc0,W
03F0   2???           01365         call    tx_send
03F1   1683 1303      01366     banksel crc1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03F3   082F           01367         movf    crc1,W
03F4   2???           01368         call    tx_send
03F5   2???           01369         goto    endflag
                      01370 
03F6                  01371 endflag:
03F6   307E           01372         movlw   0x7e
03F7   2???           01373         call    tx_send_noescape
03F8   1683 1303      01374     banksel txreturn
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03FA   18B4           01375     btfsc       txreturn,1          ;; Cant allow this rutine, the device sends back flags and crc, but 
                            the rest is zeroes (?)
03FB   2???           01376     goto        txoops
03FC   1683 1303      01377     banksel rc_listen
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
03FE   10A5           01378     bcf     rc_listen,1
                      01379 
                      01380     ;; Disable TX enable
03FF   1283 1303      01381     banksel OUTREG
0401   1206           01382         bcf     OUTREG,OUTNUM
                      01383 
0402   0008           01384         return
                      01385 
0403                  01386 trd:
                      01387     ;; Three random delays before sending broadcast
0403   2???           01388         call    lfsr_func               
0404   1683 1303      01389     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0406   0824           01390         movf    rand,W
0407   2???           01391         call    Delay
0408   2???           01392         call    lfsr_func
0409   1683 1303      01393     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
040B   0824           01394         movf    rand,W
040C   2???           01395         call    Delay
040D   2???           01396         call    lfsr_func
040E   1683 1303      01397     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0410   0824           01398         movf    rand,W
0411   2???           01399         call    Delay
0412   0008           01400         return
                      01401         
0413                  01402 lfsr_func:
0413   1683 1303      01403     banksel rand
                      01404 #ifdef  ARC_18F
                      01405     rlcf     rand,W
                      01406         rlcf     rand,W
                      01407 #endif
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01408 #ifdef  ARC_16F
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0415   0D24           01409         rlf     rand,W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0416   0D24           01410         rlf     rand,W
                      01411 #endif
                      01412 #ifdef  ARC_12F
                      01413         rlf     rand,W
                      01414         rlf     rand,W
                      01415 #endif
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0417   1A24           01416         btfsc   rand,4
0418   3A01           01417         xorlw   1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0419   1AA4           01418         btfsc   rand,5
041A   3A01           01419         xorlw   1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
041B   19A4           01420         btfsc   rand,3
041C   3A01           01421         xorlw   1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
041D   00A4           01422         movwf   rand
041E   3400           01423         retlw   0
                      01424         
041F                  01425 Delay:
041F   1683 1303      01426     banksel d1
                      01427         ;; 499994 cycles
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0421   00A2           01428         movwf   d3
0422   30FF           01429         movlw   0xFF
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0423   00A1           01430         movwf   d2
0424   3032           01431         movlw   50
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0425   00A0           01432         movwf   d1
0426                  01433 Delay_0:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0426   0BA0           01434         decfsz  d1, f
0427   2???           01435         goto    Delay_0
0428   3014           01436         movlw   20                  ;; Need this for tuning
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0429   00A0           01437         movwf   d1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
042A   0BA1           01438         decfsz  d2, f
042B   2???           01439         goto    Delay_0
042C   3064           01440         movlw   100
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
042D   00A1           01441         movwf   d2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
042E   0BA2           01442         decfsz  d3, f
042F   2???           01443         goto    Delay_0
0430   0008           01444         return
                      00028 
                      00029         ;;      __config  _FCMEN_OFF& _IESO_OFF& _MCLRE_OFF& _WDT_OFF& _INTOSCIO
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00030 ;;;
                      00031 ;;;    _FCMEN_OFF           ; -- fail safe clock monitor enable off
                      00032 ;;;    _IESO_OFF            ; -- int/ext switch over enable off
                      00033 ;;;    _BOR_ON              ; default, brown out reset on
                      00034 ;;;    _CPD_OFF             ; default, data eeprom protection off
                      00035 ;;;    _CP_OFF              ; default, program code protection off
                      00036 ;;;    _MCLR_OFF            ; -- use MCLR pin as digital input
                      00037 ;;;    _PWRTE_OFF           ; default, power up timer off
                      00038 ;;;    _WDT_OFF             ; -- watch dog timer off
                      00039 ;;;    _INTOSCIO            ; -- internal osc, RA6 and RA7 I/O
                      00040 ;;;
                      00041 
                      00042 ;;;  --< constants >---------------------------------------------------
                      00043 
                      00044         radix dec
                      00045 
  00000008            00046 clock   equ     8       ; 8 MHz
  00004B00            00047 baud    equ     19200  ; 19200, 57600, or 115200
  00000004            00048 brgdiv  equ     4       ; divider value for BRG16 = 1
  00000067            00049 brgval  equ     (clock*10000000/baud/brgdiv+5)/10-1
                      00050 
                      00051 
                      00052         cblock  USER_VARIABLE_SPACE
  00000020            00053     dd1
  00000021            00054     dd2
  00000022            00055     dd3
  00000023            00056     w1
  00000024            00057     w2
  00000025            00058     w3
  00000026            00059     w4
  00000027            00060     w5
  00000028            00061     main_commands          ; |X-------|b7 = NoNE
                      00062                            ; |-X------|b6 = NoNE
                      00063                            ; |--X-----|b5 = NoNE
                      00064                            ; |---X----|b4 = NoNE
                      00065                            ; |----X---|b3 = NoNE
                      00066                            ; |-----X--|b2 = PIR Beep on movment, set.
                      00067                            ; |------X-|b1 = If you set this to one, then the main loop will send back al
                            l the tags.
                      00068                            ; |-------X|b0 = If you set this to one, the next tag readed will be sent to 
                            the bus.
  00000029            00069     csum
  0000002A            00070     divisL
  0000002B            00071     divisH
  0000002C            00072     remdrL    ; and then into partial remainder
  0000002D            00073     remdrH
  0000002E            00074     bitcnt
  0000002F            00075     divid0
  00000030            00076     divid1
  00000031            00077     divid2
  00000032            00078     divid3
  00000033            00079     temp_parameter
  00000034            00080     temprem_parameter
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000035            00081     hum_parameter
  00000036            00082     humrem_parameter
  00000037            00083     spb_bool_params        ; |X-------|b7 = NoNE
                      00084                            ; |-X------|b6 = NoNE
                      00085                            ; |--X-----|b5 = NoNE
                      00086                            ; |---X----|b4 = NoNE
                      00087                            ; |----X---|b3 = NoNE
                      00088                            ; |-----X--|b2 = NoNE
                      00089                            ; |------X-|b1 = Beep on PIR movment. Parm5
                      00090                            ; |-------X|b0 = Light up led on PIR movment: Parm4
  00000038            00091     beep_on_movmentc
                      00092         endc
                      00093 
                      00094         org     0x000
0000   2???           00095         goto    v_reset
                      00096         org     0x004
0004   2???           00097         goto    intserv
                      00098 
                      00099 
0005                  00100 v_reset:
0005   0183           00101                   clrf    STATUS ; force bank 0 and IRP = 0        |B0
0006   1283 1303      00102               banksel INTCON
0008   138B           00103               bcf         INTCON, GIE
0009   2???           00104                   goto    Init   ;                                 |B0
                      00105 
                      00106         ;; ******************************************************************
                      00107         ;;   main init                                                      *
                      00108         ;; ******************************************************************
                      00109 
000A                  00110 Init:
                      00111 
000A   1283 1703      00112               banksel ANSEL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000C   019E           00113                   clrf    ANSEL      ; turn off ADC pins               |B2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   151E           00114               bsf     ANSEL, 2
000E   1283 1703      00115                   banksel ANSELH
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0010   019F           00116               clrf    ANSELH     ; turn off ADC pins               |B2
                      00117 
0011   1683 1303      00118              banksel ADCON1
0013   3060           00119              MOVLW B'01100000'
                      00120              ;A/D RC clock
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0014   009F           00121              MOVWF ADCON1
                      00122              ;banksel ANSEL
                      00123              ;BSF ANSEL,3
                      00124              ;BSF ANSEL,7
                      00125 
                      00126         ;;
                      00127         ;;   setup 8 MHz INTOSC
                      00128         ;;
0015   1683 1303      00129               banksel OSCCON
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00130 
0017   3070           00131                   movlw   b'01110000' ; '01110000'                      |B1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0018   008F           00132                   movwf   OSCCON      ;                                 |B1
0019                  00133 Stable:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0019   1D0F           00134                   btfss   OSCCON,HTS ; osc stable? yes, skip, else     |B1
001A   2???           00135                   goto    Stable     ; test again                      |B1
                      00136         ;;
                      00137         ;;   setup ports
                      00138         ;;
001B   1683 1303      00139             banksel TRISA
001D   30FF           00140                   movlw b'11111111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001E   0085           00141                   movwf TRISA   ; Make PortA all input
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001F   0186           00142                   clrf    TRISB ; setup PORT B all outputs        |B1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0020   0187           00143                   clrf    TRISC ; setup PORT C all outputs        |B1
                      00144               ;bsf     TRISC, 2
                      00145               ;bsf     TRISC, 3
                      00146     ;;
                      00147         ;; Set interupts
                      00148         ;;
0021   1683 1303      00149         banksel PIE1
0023   3020           00150                 movlw   b'00100000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0024   008C           00151                 movwf   PIE1
                      00152 
                      00153         ;;
                      00154         ;;   setup UART module for 19200 baud (8 MHz Clock)
                      00155         ;;
0025   1683 1303      00156               banksel SPBRG
0027   3067           00157                   movlw   low(brgval) ;                                 |B1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0028   0099           00158                   movwf   SPBRG       ;                                 |B1
0029   1683 1303      00159                   banksel SPBRGH
002B   3000           00160               movlw   high(brgval) ;                                 |B1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002C   009A           00161                   movwf   SPBRGH       ;                                 |B1
002D   1683 1303      00162               banksel BAUDCTL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002F   159B           00163                   bsf     BAUDCTL,BRG16 ; select 16 bit BRG               |B1
0030   1683 1303      00164                   banksel TXSTA
0032   3024           00165               movlw   b'00100100'       ; '0-------' CSRC, n/a (async)    |B1
                      00166         ;;  '-0------' TX9 off, 8 bits      |B1
                      00167         ;;  '--1-----' TXEN, tx enabled     |B1
                      00168         ;;  '---0----' SYNC, async mode     |B1
                      00169         ;;  '----0---' SENDB, send brk      |B1
                      00170         ;;  '-----1--' BRGH, high speed     |B1
                      00171         ;;  '------00' TRMT, TX9D           |B1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0033   0098           00172                   movwf   TXSTA ;                                 |B1
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0034   1283 1303      00173               banksel RCSTA
0036   3090           00174                   movlw   b'10010000' ; '1-------' SPEN, port enabled   |B0
                      00175         ;;  '-0------' RX9 off, 8 bits      |B0
                      00176         ;;  '--0-----' SREN, n/a (async)    |B0
                      00177         ;;  '---1----' CREN, rx enabled     |B0
                      00178         ;;  '----0---' ADDEN off            |B0
                      00179         ;;  '-----000' FERR, OERR, RX9D     |B0
0037   0098           00180                   movwf   RCSTA ;                                 |B0
0038   081A           00181                   movf    RCREG,W ; flush Rx Buffer                 |B0
0039   081A           00182                   movf    RCREG,W ;                                 |B0
                      00183 
                      00184         ;;
                      00185         ;; SET RX/TX parameters
                      00186         ;;
003A   1683 1303      00187         banksel txreturn
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003C   01B4           00188         clrf    txreturn
                      00189         ;;      Do not clear the adress:es, use the one that is set, read the speedbus text, "Adress han
                            deling system!"
                      00190         ;;      clrf    adress1
                      00191         ;;      movlw   0x7e
                      00192         ;;      movwf   adress1
                      00193         ;;      movlw   0x7d
                      00194         ;;      movwf   adress2
                      00195         ;;      clrf    adress1
                      00196         ;;      clrf    adress2
                      00197 
                      00198         ;;
                      00199         ;; Set Interrupts
                      00200         ;;
003D   1283 1303      00201         banksel INTCON
003F   178B           00202                 bsf     INTCON, GIE
0040   170B           00203                 bsf     INTCON, PEIE
0041   2???           00204         call    init_speedlib ; IMPORTANT to run this before, so the adresses are
                      00205                               ; imported from EEPROM
                      00206 
0042   1283 1303      00207         banksel PORTC
0044   1007           00208         bcf     PORTC, 0
0045   1787           00209         bsf     PORTC, 7
0046   1707           00210         bsf     PORTC, 6
                      00211 
0047   1283 1303      00212         banksel main_commands
0049   1028           00213         bcf     main_commands, 0
004A   10A8           00214         bcf     main_commands, 1
004B   1037           00215         bcf     spb_bool_params, 0
004C   10B7           00216         bcf     spb_bool_params, 1
                      00217 
004D                  00218 main:
004D   1283 1303      00219     banksel RCSTA
004F   1898           00220         btfsc   RCSTA,OERR
0050   2???           00221         call    recerror
                      00222         ;btfsc  PORTA, 0
                      00223         ;call   txporta
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0051   1683 1303      00224     banksel rand
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0053   0AA4           00225         incf    rand,F          ; Increase the random value
                      00226 
                      00227 
0054   1283 1303      00228     banksel spb_bool_params
0056   1837           00229     btfsc   spb_bool_params, 0
0057   2???           00230     goto    led_on_pir_movment
0058                  00231 main_ret1:
0058   1283 1303      00232     banksel spb_bool_params
005A   18B7           00233     btfsc   spb_bool_params, 1
005B   2???           00234     goto    beep_on_pir_movment
005C                  00235 main_ret2:
                      00236 
005C   2???           00237     goto    main
                      00238 
                      00239 
005D                  00240 led_on_pir_movment:
005D   1283 1303      00241     banksel PORTA
005F   1A05           00242     btfsc   PORTA, 4
0060   1706           00243     bsf     PORTB, 6
0061   1E05           00244     btfss   PORTA, 4
0062   1306           00245     bcf     PORTB, 6
0063   2???           00246     goto    main_ret1
                      00247 
0064                  00248 beep_on_pir_movment:
0064   1283 1303      00249     banksel PORTA
0066   1E05           00250     btfss   PORTA, 4
0067   2???           00251     goto    beep_on_pir_movment_ret
0068   1928           00252     btfsc   main_commands, 2
0069   2???           00253     goto    main_ret2
006A   1528           00254     bsf     main_commands, 2
                      00255 
006B   1283 1303      00256     banksel PORTC
006D   1687           00257     bsf     PORTC, 5
006E   3019           00258     movlw   25
006F   2???           00259     call    Delay
0070   1283 1303      00260     banksel PORTC
0072   1287           00261     bcf     PORTC, 5
0073   3019           00262     movlw   25
0074   2???           00263     call    Delay
0075   1283 1303      00264     banksel PORTC
0077   1687           00265     bsf     PORTC, 5
0078   3019           00266     movlw   25
0079   2???           00267     call    Delay
007A   1283 1303      00268     banksel PORTC
007C   1287           00269     bcf     PORTC, 5
007D   2???           00270     goto    main_ret2
                      00271 
007E                  00272 beep_on_pir_movment_ret:
007E   1128           00273     bcf     main_commands, 2
007F   2???           00274     goto    main_ret2
                      00275 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00276 
0080                  00277 spb_parameters:
0080   2???           00278     call    func_set_rsp_addr
                      00279 
0081   30D1           00280     movlw   rcframe+7
0082   0084           00281     movwf   FSR
                      00282 
                      00283 
                      00284     if_parameter 0x00, spb_parameters_temp
0083   3000               M         movlw   0x00
0084   1383               M     bankisel rcframe
0085   0200               M         subwf   INDF,W
0086   1903               M         btfsc   STATUS,Z
0087   2???               M     goto    spb_parameters_temp
                      00285 
                      00286     ; Get temp
0088   3000           00287         movlw   0x00
0089   1383           00288     bankisel rcframe
008A   0200           00289         subwf   INDF,W
008B   1903           00290         btfsc   STATUS,Z
008C   2???           00291     goto    spb_parameters_temp
                      00292 
                      00293     ; Get hum
008D   3001           00294         movlw   0x01
008E   1383           00295     bankisel rcframe
008F   0200           00296         subwf   INDF,W
0090   1903           00297         btfsc   STATUS,Z
0091   2???           00298     goto    spb_parameters_hum
                      00299 
                      00300     ; Get light
0092   3002           00301         movlw   0x02
0093   1383           00302     bankisel rcframe
0094   0200           00303         subwf   INDF,W
0095   1903           00304         btfsc   STATUS,Z
0096   2???           00305     goto    spb_parameters_light
                      00306 
                      00307     ; Get/Set Led
0097   3003           00308         movlw   0x03
0098   1383           00309     bankisel rcframe
0099   0200           00310         subwf   INDF,W
009A   1903           00311         btfsc   STATUS,Z
009B   2???           00312     goto    spb_parameters_led
                      00313 
                      00314     ; Get/Set PIR Led
009C   3004           00315         movlw   0x04
009D   1383           00316     bankisel rcframe
009E   0200           00317         subwf   INDF,W
009F   1903           00318         btfsc   STATUS,Z
00A0   2???           00319     goto    spb_parameters_pir_led
                      00320 
                      00321     ; Get/Set PIR Beep
00A1   3005           00322         movlw   0x05
00A2   1383           00323     bankisel rcframe
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A3   0200           00324         subwf   INDF,W
00A4   1903           00325         btfsc   STATUS,Z
00A5   2???           00326     goto    spb_parameters_pir_beep
                      00327 
                      00328     ; Get/Set Beep
00A6   3006           00329         movlw   0x06
00A7   1383           00330     bankisel rcframe
00A8   0200           00331         subwf   INDF,W
00A9   1903           00332         btfsc   STATUS,Z
00AA   2???           00333     goto    spb_parameters_beep
                      00334 
00AB   2???           00335     goto    restore
                      00336 
                      00337 
00AC                  00338 spb_parameters_led:
00AC   1683 1303      00339     banksel rc_counter
00AE   300A           00340     movlw   10
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00AF   0226           00341     subwf   rc_counter,W
00B0   1903           00342     btfsc   STATUS,Z
00B1   2???           00343     goto    spb_getparameters_led
00B2   2???           00344     goto    spb_setparameters_led
00B3   2???           00345     goto    restore
                      00346 
00B4                  00347 spb_parameters_beep:
00B4   1683 1303      00348     banksel rc_counter
00B6   300A           00349     movlw   10
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B7   0226           00350     subwf   rc_counter,W
00B8   1903           00351     btfsc   STATUS,Z
00B9   2???           00352     goto    spb_getparameters_beep
00BA   2???           00353     goto    spb_setparameters_beep
00BB   2???           00354     goto    restore
                      00355 
00BC                  00356 spb_parameters_pir_led:
00BC   1683 1303      00357     banksel rc_counter
00BE   300A           00358     movlw   10
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BF   0226           00359     subwf   rc_counter,W
00C0   1903           00360     btfsc   STATUS,Z
00C1   2???           00361     goto    spb_getparameters_pir_led
00C2   2???           00362     goto    spb_setparameters_pir_led
00C3   2???           00363     goto    restore
                      00364 
00C4                  00365 spb_parameters_pir_beep:
00C4   1683 1303      00366     banksel rc_counter
00C6   300A           00367     movlw   10
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C7   0226           00368     subwf   rc_counter,W
00C8   1903           00369     btfsc   STATUS,Z
00C9   2???           00370     goto    spb_getparameters_pir_beep
00CA   2???           00371     goto    spb_setparameters_pir_beep
00CB   2???           00372     goto    restore
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00373 
00CC                  00374 spb_parameters_temp:
00CC   2???           00375     call    read_humtemp
00CD   2???           00376     call    set_humtemp_parameter
                      00377     ;;; Send back parameter ->
                      00378 
                      00379     ;; Send the readed rfid
00CE   1683 1303      00380     banksel framelen
00D0   300C           00381         movlw   12
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D1   00B2           00382         movwf   framelen
                      00383 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D2   0829           00384     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D3   00B5           00385         movwf   txframe
                      00386 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D4   082A           00387     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D5   00B6           00388         movwf   txframe+1
                      00389 
                      00390     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D6   082B           00391         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D7   00B7           00392         movwf   txframe+2
                      00393 
                      00394     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D8   082C           00395         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00D9   00B8           00396         movwf   txframe+3
                      00397 
                      00398     ;; 0x03 control bit
00DA   3003           00399         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00DB   00B9           00400         movwf   txframe+4
                      00401 
                      00402     ;; 0x01     protocoll
00DC   3000           00403     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00DD   00BA           00404         movwf   txframe+5
                      00405 
                      00406     ;; Data
00DE   3004           00407     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00DF   00BB           00408         movwf   txframe+6
                      00409 
                      00410     ;; 0x00 Basic config response
00E0   3000           00411     movlw   0x00
00E1   1683 1303      00412     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00E3   00BC           00413     movwf   txframe+7
                      00414 
                      00415     ;; 0x00 Basic config response
00E4   1283 1303      00416     banksel temp_parameter
00E6   0833           00417         movf    temp_parameter, W
00E7   1683 1303      00418     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00E9   00BD           00419     movwf   txframe+8
                      00420 
                      00421     ;; 0x00 Basic config response
00EA   1283 1303      00422     banksel temprem_parameter
00EC   0834           00423         movf    temprem_parameter, W
00ED   1683 1303      00424     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00EF   00BE           00425     movwf   txframe+9
                      00426 
                      00427         ;; Padding bit
00F0   3000           00428         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F1   00BF           00429     movwf   txframe+10
00F2   2???           00430     call    txdo
                      00431 
                      00432     ;;;
00F3   2???           00433     goto    restore
                      00434 
00F4                  00435 spb_parameters_hum:
00F4   2???           00436     call    read_humtemp
00F5   2???           00437     call    set_humtemp_parameter
                      00438     ;;; Send back parameter ->
                      00439 
                      00440     ;; Send the readed rfid
00F6   1683 1303      00441     banksel framelen
00F8   300C           00442         movlw   12
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F9   00B2           00443         movwf   framelen
                      00444 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00FA   0829           00445     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00FB   00B5           00446         movwf   txframe
                      00447 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00FC   082A           00448     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00FD   00B6           00449         movwf   txframe+1
                      00450 
                      00451     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00FE   082B           00452         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00FF   00B7           00453         movwf   txframe+2
                      00454 
                      00455     ;; * my own src adress
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0100   082C           00456         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0101   00B8           00457         movwf   txframe+3
                      00458 
                      00459     ;; 0x03 control bit
0102   3003           00460         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0103   00B9           00461         movwf   txframe+4
                      00462 
                      00463     ;; 0x01     protocoll
0104   3000           00464     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0105   00BA           00465         movwf   txframe+5
                      00466 
                      00467     ;; Data
0106   3004           00468     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0107   00BB           00469         movwf   txframe+6
                      00470 
                      00471     ;; 0x00 Basic config response
0108   3001           00472     movlw   0x01
0109   1683 1303      00473     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
010B   00BC           00474     movwf   txframe+7
                      00475 
                      00476     ;; 0x00 Basic config response
010C   1283 1303      00477     banksel hum_parameter
010E   0835           00478         movf    hum_parameter, W
010F   1683 1303      00479     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0111   00BD           00480     movwf   txframe+8
                      00481 
                      00482     ;; 0x00 Basic config response
0112   1283 1303      00483     banksel humrem_parameter
0114   0836           00484         movf    humrem_parameter, W
0115   1683 1303      00485     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0117   00BE           00486     movwf   txframe+9
                      00487 
                      00488         ;; Padding bit
0118   3000           00489         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0119   00BF           00490     movwf   txframe+10
011A   2???           00491     call    txdo
                      00492 
                      00493     ;;;
011B   2???           00494     goto    restore
                      00495 
                      00496 
011C                  00497 spb_parameters_light:
                      00498     ;;; Read AD value ->
011C   1683 1303      00499     banksel ADCON1
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

011E   3070           00500     movlw b'01110000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
011F   009F           00501     movwf   ADCON1
0120   1283 1703      00502     banksel ANSEL
0122   3002           00503     movlw   2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0123   009E           00504     movwf   ANSEL
0124   1283 1303      00505     banksel ADCON0
0126   308B           00506     movlw b'10001011'
0127   009F           00507     movwf   ADCON0
0128   2???           00508     call    Delay_005_ms
0129   2???           00509     call    Delay_005_ms
012A   2???           00510     call    Delay_005_ms
012B   2???           00511     call    Delay_005_ms
012C   1283 1303      00512     banksel ADCON0
012E   189F           00513     btfsc   ADCON0, GO
012F   2???           00514     goto    $-1
0130   139F           00515     bcf     ADCON0, 7
                      00516 
                      00517 
                      00518     ;; Send the readed rfid
0131   1683 1303      00519     banksel framelen
0133   300C           00520         movlw   12
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0134   00B2           00521         movwf   framelen
                      00522 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0135   0829           00523     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0136   00B5           00524         movwf   txframe
                      00525 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0137   082A           00526     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0138   00B6           00527         movwf   txframe+1
                      00528 
                      00529     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0139   082B           00530         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013A   00B7           00531         movwf   txframe+2
                      00532 
                      00533     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013B   082C           00534         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013C   00B8           00535         movwf   txframe+3
                      00536 
                      00537     ;; 0x03 control bit
013D   3003           00538         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013E   00B9           00539         movwf   txframe+4
                      00540 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00541     ;; 0x01     protocoll
013F   3000           00542     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0140   00BA           00543         movwf   txframe+5
                      00544 
                      00545     ;; Data
0141   3004           00546     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0142   00BB           00547         movwf   txframe+6
                      00548 
                      00549     ;; 0x00 Basic config response
0143   3002           00550     movlw   0x02
0144   1683 1303      00551     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0146   00BC           00552     movwf   txframe+7
                      00553 
                      00554     ;; 0x00 Basic config response
0147   1283 1303      00555     banksel ADRESH
0149   081E           00556     movf    ADRESH, W
014A   1683 1303      00557     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
014C   00BD           00558     movwf   txframe+8
                      00559 
                      00560     ;; 0x00 Basic config response
014D   1683 1303      00561     banksel ADRESL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
014F   081E           00562     movf    ADRESL, W
0150   1683 1303      00563     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0152   00BE           00564     movwf   txframe+9
                      00565 
                      00566         ;; Padding bit
0153   3000           00567         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0154   00BF           00568     movwf   txframe+10
0155   2???           00569     call    txdo
                      00570 
                      00571     ;;;
0156   2???           00572     goto    restore
                      00573 
0157                  00574 spb_setparameters_led:
0157   30D2           00575     movlw   rcframe+8
0158   0084           00576     movwf   FSR
                      00577 
0159   1683 1303      00578     banksel rcframe
015B   1800           00579     btfsc   INDF, 0
015C   2???           00580     goto    spb_setparameters_led_on
015D   1C00           00581     btfss   INDF, 0
015E   2???           00582     goto    spb_setparameters_led_off
                      00583 
015F                  00584 spb_setparameters_led_on:
015F   1283 1303      00585     banksel PORTB
0161   1706           00586     bsf     PORTB, 6
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0162   2???           00587     goto    spb_getparameters_led
                      00588 
0163                  00589 spb_setparameters_led_off:
0163   1283 1303      00590     banksel PORTB
0165   1306           00591     bcf     PORTB, 6
0166   2???           00592     goto    spb_getparameters_led
                      00593 
                      00594 
0167                  00595 spb_getparameters_led:
                      00596 
                      00597     ;; Send the readed rfid
0167   1683 1303      00598     banksel framelen
0169   300B           00599         movlw   11
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016A   00B2           00600         movwf   framelen
                      00601 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016B   0829           00602     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016C   00B5           00603         movwf   txframe
                      00604 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016D   082A           00605     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016E   00B6           00606         movwf   txframe+1
                      00607 
                      00608     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016F   082B           00609         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0170   00B7           00610         movwf   txframe+2
                      00611 
                      00612     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0171   082C           00613         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0172   00B8           00614         movwf   txframe+3
                      00615 
                      00616     ;; 0x03 control bit
0173   3003           00617         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0174   00B9           00618         movwf   txframe+4
                      00619 
                      00620     ;; 0x01     protocoll
0175   3000           00621     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0176   00BA           00622         movwf   txframe+5
                      00623 
                      00624     ;; Data
0177   3004           00625     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0178   00BB           00626         movwf   txframe+6
                      00627 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00628     ;; 0x00 Basic config response
0179   3003           00629     movlw   0x03
017A   1683 1303      00630     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017C   00BC           00631     movwf   txframe+7
                      00632 
                      00633     ;; 0x00 Basic config response
017D   1283 1303      00634     banksel PORTB
017F   1B06           00635     btfsc   PORTB, 6
0180   2???           00636     goto    spb_getparameters_led_on
0181   1F06           00637     btfss   PORTB, 6
0182   2???           00638     goto    spb_getparameters_led_off
                      00639 
0183                  00640 spb_getparameters_led_on:
0183   3001           00641     movlw   1
0184   1683 1303      00642     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0186   00BD           00643     movwf   txframe+8
0187   2???           00644     goto    spb_getparameters_led_ret
                      00645 
0188                  00646 spb_getparameters_led_off:
0188   3000           00647     movlw   0
0189   1683 1303      00648     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
018B   00BD           00649     movwf   txframe+8
018C   2???           00650     goto    spb_getparameters_led_ret
                      00651 
018D                  00652 spb_getparameters_led_ret:
                      00653         ;; Padding bit
018D   3000           00654         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
018E   00BE           00655     movwf   txframe+9
018F   2???           00656     call    txdo
                      00657 
                      00658     ;;;
0190   2???           00659     goto    restore
                      00660 
0191                  00661 spb_setparameters_pir_led:
0191   30D2           00662     movlw   rcframe+8
0192   0084           00663     movwf   FSR
                      00664 
0193   1683 1303      00665     banksel rcframe
0195   1800           00666     btfsc   INDF, 0
0196   2???           00667     goto    spb_setparameters_pir_led_on
0197   1C00           00668     btfss   INDF, 0
0198   2???           00669     goto    spb_setparameters_pir_led_off
                      00670 
0199                  00671 spb_setparameters_pir_led_on:
0199   1283 1303      00672     banksel spb_bool_params
019B   1437           00673     bsf     spb_bool_params, 0
019C   2???           00674     goto    spb_getparameters_pir_led
                      00675 
019D                  00676 spb_setparameters_pir_led_off:
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

019D   1283 1303      00677     banksel spb_bool_params
019F   1037           00678     bcf     spb_bool_params, 0
01A0   2???           00679     goto    spb_getparameters_pir_led
                      00680 
                      00681 
01A1                  00682 spb_getparameters_pir_led:
                      00683 
                      00684     ;; Send the readed rfid
01A1   1683 1303      00685     banksel framelen
01A3   300B           00686         movlw   11
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A4   00B2           00687         movwf   framelen
                      00688 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A5   0829           00689     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A6   00B5           00690         movwf   txframe
                      00691 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A7   082A           00692     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A8   00B6           00693         movwf   txframe+1
                      00694 
                      00695     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A9   082B           00696         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01AA   00B7           00697         movwf   txframe+2
                      00698 
                      00699     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01AB   082C           00700         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01AC   00B8           00701         movwf   txframe+3
                      00702 
                      00703     ;; 0x03 control bit
01AD   3003           00704         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01AE   00B9           00705         movwf   txframe+4
                      00706 
                      00707     ;; 0x01     protocoll
01AF   3000           00708     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B0   00BA           00709         movwf   txframe+5
                      00710 
                      00711     ;; Data
01B1   3004           00712     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B2   00BB           00713         movwf   txframe+6
                      00714 
                      00715     ;; 0x00 Basic config response
01B3   3004           00716     movlw   0x04
01B4   1683 1303      00717     banksel txframe
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01B6   00BC           00718     movwf   txframe+7
                      00719 
                      00720     ;; 0x00 Basic config response
01B7   1283 1303      00721     banksel spb_bool_params
01B9   1837           00722     btfsc   spb_bool_params, 0
01BA   2???           00723     goto    spb_getparameters_pir_led_on
01BB   1C37           00724     btfss   spb_bool_params, 0
01BC   2???           00725     goto    spb_getparameters_pir_led_off
                      00726 
01BD                  00727 spb_getparameters_pir_led_on:
01BD   3001           00728     movlw   1
01BE   1683 1303      00729     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C0   00BD           00730     movwf   txframe+8
01C1   2???           00731     goto    spb_getparameters_pir_led_ret
                      00732 
01C2                  00733 spb_getparameters_pir_led_off:
01C2   3000           00734     movlw   0
01C3   1683 1303      00735     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C5   00BD           00736     movwf   txframe+8
01C6   2???           00737     goto    spb_getparameters_pir_led_ret
                      00738 
01C7                  00739 spb_getparameters_pir_led_ret:
                      00740         ;; Padding bit
01C7   3000           00741         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C8   00BE           00742     movwf   txframe+9
01C9   2???           00743     call    txdo
                      00744 
                      00745     ;;;
01CA   2???           00746     goto    restore
                      00747 
01CB                  00748 spb_setparameters_pir_beep:
01CB   30D2           00749     movlw   rcframe+8
01CC   0084           00750     movwf   FSR
                      00751 
01CD   1683 1303      00752     banksel rcframe
01CF   1800           00753     btfsc   INDF, 0
01D0   2???           00754     goto    spb_setparameters_pir_beep_on
01D1   1C00           00755     btfss   INDF, 0
01D2   2???           00756     goto    spb_setparameters_pir_beep_off
                      00757 
01D3                  00758 spb_setparameters_pir_beep_on:
01D3   1283 1303      00759     banksel spb_bool_params
01D5   14B7           00760     bsf     spb_bool_params, 1
01D6   2???           00761     goto    spb_getparameters_pir_beep
                      00762 
01D7                  00763 spb_setparameters_pir_beep_off:
01D7   1283 1303      00764     banksel spb_bool_params
01D9   10B7           00765     bcf     spb_bool_params, 1
01DA   2???           00766     goto    spb_getparameters_pir_beep
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00767 
                      00768 
01DB                  00769 spb_getparameters_pir_beep:
                      00770 
                      00771     ;; Send the readed rfid
01DB   1683 1303      00772     banksel framelen
01DD   300B           00773         movlw   11
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DE   00B2           00774         movwf   framelen
                      00775 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DF   0829           00776     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E0   00B5           00777         movwf   txframe
                      00778 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E1   082A           00779     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E2   00B6           00780         movwf   txframe+1
                      00781 
                      00782     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E3   082B           00783         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E4   00B7           00784         movwf   txframe+2
                      00785 
                      00786     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E5   082C           00787         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E6   00B8           00788         movwf   txframe+3
                      00789 
                      00790     ;; 0x03 control bit
01E7   3003           00791         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E8   00B9           00792         movwf   txframe+4
                      00793 
                      00794     ;; 0x01     protocoll
01E9   3000           00795     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01EA   00BA           00796         movwf   txframe+5
                      00797 
                      00798     ;; Data
01EB   3004           00799     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01EC   00BB           00800         movwf   txframe+6
                      00801 
                      00802     ;; 0x00 Basic config response
01ED   3005           00803     movlw   0x05
01EE   1683 1303      00804     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01F0   00BC           00805     movwf   txframe+7
                      00806 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00807     ;; 0x00 Basic config response
01F1   1283 1303      00808     banksel spb_bool_params
01F3   18B7           00809     btfsc   spb_bool_params, 1
01F4   2???           00810     goto    spb_getparameters_pir_beep_on
01F5   1CB7           00811     btfss   spb_bool_params, 1
01F6   2???           00812     goto    spb_getparameters_pir_beep_off
                      00813 
01F7                  00814 spb_getparameters_pir_beep_on:
01F7   3001           00815     movlw   1
01F8   1683 1303      00816     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01FA   00BD           00817     movwf   txframe+8
01FB   2???           00818     goto    spb_getparameters_pir_beep_ret
                      00819 
01FC                  00820 spb_getparameters_pir_beep_off:
01FC   3000           00821     movlw   0
01FD   1683 1303      00822     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01FF   00BD           00823     movwf   txframe+8
0200   2???           00824     goto    spb_getparameters_pir_beep_ret
                      00825 
0201                  00826 spb_getparameters_pir_beep_ret:
                      00827         ;; Padding bit
0201   3000           00828         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0202   00BE           00829     movwf   txframe+9
0203   2???           00830     call    txdo
                      00831 
                      00832     ;;;
0204   2???           00833     goto    restore
                      00834 
                      00835 
0205                  00836 spb_setparameters_beep:
0205   30D2           00837     movlw   rcframe+8
0206   0084           00838     movwf   FSR
                      00839 
0207   1683 1303      00840     banksel rcframe
0209   1800           00841     btfsc   INDF, 0
020A   2???           00842     goto    spb_setparameters_beep_on
020B   1C00           00843     btfss   INDF, 0
020C   2???           00844     goto    spb_setparameters_beep_off
                      00845 
020D                  00846 spb_setparameters_beep_on:
020D   1283 1303      00847     banksel PORTC
020F   1687           00848     bsf     PORTC, 5
0210   2???           00849     goto    spb_getparameters_beep
                      00850 
0211                  00851 spb_setparameters_beep_off:
0211   1283 1303      00852     banksel PORTC
0213   1287           00853     bcf     PORTC, 5
0214   2???           00854     goto    spb_getparameters_beep
                      00855 
                      00856 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0215                  00857 spb_getparameters_beep:
                      00858 
                      00859     ;; Send the readed rfid
0215   1683 1303      00860     banksel framelen
0217   300B           00861         movlw   11
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0218   00B2           00862         movwf   framelen
                      00863 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0219   0829           00864     movf    rsp_adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021A   00B5           00865         movwf   txframe
                      00866 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021B   082A           00867     movf    rsp_adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021C   00B6           00868         movwf   txframe+1
                      00869 
                      00870     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021D   082B           00871         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021E   00B7           00872         movwf   txframe+2
                      00873 
                      00874     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021F   082C           00875         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0220   00B8           00876         movwf   txframe+3
                      00877 
                      00878     ;; 0x03 control bit
0221   3003           00879         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0222   00B9           00880         movwf   txframe+4
                      00881 
                      00882     ;; 0x01     protocoll
0223   3000           00883     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0224   00BA           00884         movwf   txframe+5
                      00885 
                      00886     ;; Data
0225   3004           00887     movlw       0x04
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0226   00BB           00888         movwf   txframe+6
                      00889 
                      00890     ;; 0x00 Basic config response
0227   3006           00891     movlw   0x06
0228   1683 1303      00892     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
022A   00BC           00893     movwf   txframe+7
                      00894 
                      00895     ;; 0x00 Basic config response
022B   1283 1303      00896     banksel PORTC
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

022D   1A87           00897     btfsc   PORTC, 5
022E   2???           00898     goto    spb_getparameters_beep_on
022F   1E87           00899     btfss   PORTC, 5
0230   2???           00900     goto    spb_getparameters_beep_off
                      00901 
0231                  00902 spb_getparameters_beep_on:
0231   3001           00903     movlw   1
0232   1683 1303      00904     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0234   00BD           00905     movwf   txframe+8
0235   2???           00906     goto    spb_getparameters_beep_ret
                      00907 
0236                  00908 spb_getparameters_beep_off:
0236   3000           00909     movlw   0
0237   1683 1303      00910     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0239   00BD           00911     movwf   txframe+8
023A   2???           00912     goto    spb_getparameters_beep_ret
                      00913 
023B                  00914 spb_getparameters_beep_ret:
                      00915         ;; Padding bit
023B   3000           00916         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
023C   00BE           00917     movwf   txframe+9
023D   2???           00918     call    txdo
                      00919 
                      00920     ;;;
023E   2???           00921     goto    restore
                      00922 
                      00923 
023F                  00924 read_humtemp:
                      00925 
023F   3027           00926     movlw   w5
0240   0084           00927     movwf   FSR
                      00928 
0241   1683 1303      00929     banksel TRISA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0243   1005           00930     bcf     TRISA, 0
0244   1283 1303      00931     banksel PORTA
0246   1005           00932     bcf     PORTA, 0
0247   2???           00933     call    Delay_005_ms
0248   2???           00934     call    Delay_005_ms
0249   2???           00935     call    Delay_005_ms
024A   2???           00936     call    Delay_005_ms        ;; 2ms
024B   1683 1303      00937     banksel TRISA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
024D   1405           00938     bsf     TRISA, 0
024E   2???           00939     call    Delay_005_ms
                      00940 
024F   2???           00941     call    read_humtemp_delay
0250   2???           00942     call    read_humtemp_wait
0251   2???           00943     call    read_humtemp_delay
                      00944 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0252   3005           00945     movlw   5
0253   1283 1303      00946     banksel dd3
0255   00A2           00947     movwf   dd3
0256                  00948 read_humtemp_loop1:
                      00949     ;; Write in bit 1
0256   2???           00950     call    Delay_005_ms
0257   1C05           00951     btfss   PORTA, 0
0258   1380           00952     bcf     INDF, 7
0259   1805           00953     btfsc   PORTA, 0
025A   1780           00954     bsf     INDF, 7
025B   2???           00955     call    read_humtemp_wait
025C   2???           00956     call    read_humtemp_delay
                      00957 
                      00958     ;; Write in bit 2
025D   2???           00959     call    Delay_005_ms
025E   1C05           00960     btfss   PORTA, 0
025F   1300           00961     bcf     INDF, 6
0260   1805           00962     btfsc   PORTA, 0
0261   1700           00963     bsf     INDF, 6
0262   2???           00964     call    read_humtemp_wait
0263   2???           00965     call    read_humtemp_delay
                      00966 
                      00967     ;; Write in bit 3
0264   2???           00968      call    Delay_005_ms
0265   1C05           00969     btfss   PORTA, 0
0266   1280           00970     bcf     INDF, 5
0267   1805           00971     btfsc   PORTA, 0
0268   1680           00972     bsf     INDF, 5
0269   2???           00973     call    read_humtemp_wait
026A   2???           00974     call    read_humtemp_delay
                      00975 
                      00976     ;; Write in bit 4
026B   2???           00977     call    Delay_005_ms
026C   1C05           00978     btfss   PORTA, 0
026D   1200           00979     bcf     INDF, 4
026E   1805           00980     btfsc   PORTA, 0
026F   1600           00981     bsf     INDF, 4
0270   2???           00982     call    read_humtemp_wait
0271   2???           00983     call    read_humtemp_delay
                      00984 
                      00985     ;; Write in bit 5
0272   2???           00986     call    Delay_005_ms
0273   1C05           00987     btfss   PORTA, 0
0274   1180           00988     bcf     INDF, 3
0275   1805           00989     btfsc   PORTA, 0
0276   1580           00990     bsf     INDF, 3
0277   2???           00991     call    read_humtemp_wait
0278   2???           00992     call    read_humtemp_delay
                      00993 
                      00994     ;; Write in bit 6
0279   2???           00995     call    Delay_005_ms
027A   1C05           00996     btfss   PORTA, 0
027B   1100           00997     bcf     INDF, 2
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

027C   1805           00998     btfsc   PORTA, 0
027D   1500           00999     bsf     INDF, 2
027E   2???           01000     call    read_humtemp_wait
027F   2???           01001     call    read_humtemp_delay
                      01002 
                      01003     ;; Write in bit 7
0280   2???           01004     call    Delay_005_ms
0281   1C05           01005     btfss   PORTA, 0
0282   1080           01006     bcf     INDF, 1
0283   1805           01007     btfsc   PORTA, 0
0284   1480           01008     bsf     INDF, 1
0285   2???           01009     call    read_humtemp_wait
0286   2???           01010     call    read_humtemp_delay
                      01011 
                      01012     ;; Write in bit 8
0287   2???           01013     call    Delay_005_ms
0288   1C05           01014     btfss   PORTA, 0
0289   1000           01015     bcf     INDF, 0
028A   1805           01016     btfsc   PORTA, 0
028B   1400           01017     bsf     INDF, 0
028C   2???           01018     call    read_humtemp_wait
028D   2???           01019     call    read_humtemp_delay
                      01020 
028E   0384           01021     decf    FSR, f
028F   0BA2           01022         decfsz  dd3, f
0290   2???           01023     goto    read_humtemp_loop1
                      01024 
0291   1283 1303      01025     banksel csum
0293   01A9           01026     clrf    csum
0294   0827           01027     movf    w5, W
Message[305]: Using default destination of 1 (file).
0295   07A9           01028     addwf   csum
0296   0826           01029     movf    w4, W
Message[305]: Using default destination of 1 (file).
0297   07A9           01030     addwf   csum
0298   0825           01031     movf    w3, W
Message[305]: Using default destination of 1 (file).
0299   07A9           01032     addwf   csum
029A   0824           01033     movf    w2, W
Message[305]: Using default destination of 1 (file).
029B   07A9           01034     addwf   csum
                      01035 
029C   0823           01036     movf    w1, W
029D   0229           01037     subwf       csum,W
029E   1D03           01038     btfss       STATUS,Z
029F   2???           01039     goto        read_humtemp_ret
                      01040 
                      01041 
                      01042 
02A0                  01043 read_humtemp_ret:
02A0   0008           01044     return
                      01045 
02A1                  01046 read_humtemp_wait:
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02A1   1283 1303      01047     banksel PORTA
02A3   1805           01048     btfsc   PORTA, 0
02A4   2???           01049     goto    read_humtemp_wait
02A5   0008           01050     return
                      01051 
02A6                  01052 read_humtemp_delay:
02A6   1283 1303      01053     banksel dd2
02A8   3028           01054     movlw   40
02A9   00A1           01055     movwf   dd2
02AA                  01056 read_humtemp_delay_loop:
02AA   2???           01057     call    Delay_001_ms
02AB   1283 1303      01058     banksel PORTA
02AD   1805           01059     btfsc   PORTA, 0
02AE   0008           01060     return
02AF   1283 1303      01061     banksel dd2
02B1   0BA1           01062         decfsz  dd2, f
02B2   2???           01063     goto    read_humtemp_delay_loop
02B3   0008           01064     return
                      01065 
                      01066 
02B4                  01067 set_humtemp_parameter:
                      01068     ;;
02B4   1283 1303      01069     banksel divid0
02B6   01AF           01070     clrf    divid0
02B7   01B0           01071     clrf    divid1
02B8   01B1           01072     clrf    divid2
02B9   01B2           01073     clrf    divid3
                      01074 
                      01075 
                      01076 ; Take the Humidelty and divide by 10.
02BA   01AB           01077     clrf    divisH
02BB   300A           01078     movlw   10
02BC   00AA           01079     movwf   divisL
                      01080 
02BD   0827           01081     movf    w5, W
02BE   00B0           01082     movwf   divid1
02BF   0826           01083     movf    w4, W
02C0   00AF           01084     movwf   divid0
                      01085 ;
02C1   2???           01086     call    divide
                      01087 
02C2   082F           01088     movf    divid0, W
02C3   00B5           01089     movwf   hum_parameter
02C4   082C           01090     movf    remdrL, W
02C5   00B6           01091     movwf   humrem_parameter
                      01092 
                      01093 ; Take temp and divide by 10
02C6   01AB           01094     clrf    divisH
02C7   300A           01095     movlw   10
02C8   00AA           01096     movwf   divisL
                      01097 
02C9   01B1           01098     clrf    divid2
02CA   01B2           01099     clrf    divid3
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02CB   0825           01100     movf    w3, W
02CC   00B0           01101     movwf   divid1
                      01102 ; Clear the below zero bit
02CD   13B0           01103     bcf     divid1, 7
02CE   0824           01104     movf    w2, W
02CF   00AF           01105     movwf   divid0
                      01106 ;
02D0   2???           01107     call    divide
                      01108 
02D1   1BA5           01109     btfsc   w3, 7
02D2   2???           01110     goto    temp_below_zero
                      01111     ; Temp is abowe or zero
02D3   082F           01112     movf    divid0, W
02D4   00B3           01113     movwf   temp_parameter
02D5   082C           01114     movf    remdrL, W
02D6   00B4           01115     movwf   temprem_parameter
02D7   0008           01116     return
                      01117 
02D8                  01118 temp_below_zero:
                      01119     ; Temp is below or zero
02D8   30FF           01120     movlw   255
02D9   00A0           01121     movwf   dd1
02DA   082F           01122     movf    divid0, W
02DB   0220           01123     subwf   dd1, W
02DC   00B3           01124     movwf   temp_parameter
02DD   082C           01125     movf    remdrL, W
02DE   00B4           01126     movwf   temprem_parameter
02DF   0008           01127     return
                      01128 
                      01129 
02E0                  01130 send_humtemp:
                      01131     ;; Send the readed rfid
02E0   1683 1303      01132     banksel framelen
02E2   300D           01133         movlw   13
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E3   00B2           01134         movwf   framelen
                      01135 
02E4   3014           01136     movlw   20
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E5   00B5           01137         movwf   txframe
                      01138 
02E6   3014           01139     movlw   20
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E7   00B6           01140         movwf   txframe+1
                      01141 
                      01142     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E8   082B           01143         movf    adress1, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02E9   00B7           01144         movwf   txframe+2
                      01145 
                      01146     ;; * my own src adress
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02EA   082C           01147         movf    adress2, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02EB   00B8           01148         movwf   txframe+3
                      01149 
                      01150     ;; 0x03 control bit
02EC   3003           01151         movlw   0x03
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02ED   00B9           01152         movwf   txframe+4
                      01153 
                      01154     ;; 0x01     protocoll
02EE   3000           01155     movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02EF   00BA           01156         movwf   txframe+5
                      01157 
                      01158     ;; Data
02F0   300A           01159     movlw       0x0A
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F1   00BB           01160         movwf   txframe+6
                      01161 
                      01162     ;; 0x00 Basic config response
02F2   1283 1303      01163     banksel w5
02F4   0827           01164         movf    w5, W
02F5   1683 1303      01165     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02F7   00BC           01166     movwf   txframe+7
                      01167 
                      01168     ;; 0x00 Basic config response
02F8   1283 1303      01169     banksel w4
02FA   0826           01170         movf    w4, W
02FB   1683 1303      01171     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02FD   00BD           01172     movwf   txframe+8
                      01173 
                      01174     ;; 0x00 Basic config response
02FE   1283 1303      01175     banksel divid0
0300   082F           01176         movf    divid0, W
0301   1683 1303      01177     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0303   00BE           01178     movwf   txframe+9
                      01179 
                      01180     ;; Data - DeviceID
0304   1283 1303      01181     banksel remdrL
0306   082C           01182     movf    remdrL, W
0307   1683 1303      01183     banksel txframe
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0309   00BF           01184         movwf   txframe+10
                      01185 
                      01186         ;; Padding bit
030A   3000           01187         movlw   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
030B   00C0           01188     movwf   txframe+11
030C   2???           01189     call    txdo
030D   0008           01190     return
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01191 
                      01192 
030E                  01193 custom_command_handler:
030E   300A           01194         movlw   0x0A            ;; Set the get tagg bit
030F   1383           01195         bankisel rcframe
0310   0200           01196         subwf   INDF,W
0311   1903           01197         btfsc   STATUS,Z
0312   2???           01198         goto    get_humtemp
0313   2???           01199         goto    restore
                      01200 
0314                  01201 get_humtemp:
0314   2???           01202         call    read_humtemp
0315   2???           01203         call    send_humtemp
0316   2???           01204         goto    restore
                      01205 
                      01206 
0317                  01207 divide:
0317   3020           01208     movlw   32      ; 32-bit divide by 16-bit
0318   00AE           01209     movwf   bitcnt
0319   01AD           01210     clrf    remdrH   ; Clear remainder
031A   01AC           01211     clrf    remdrL
                      01212 
031B                  01213 dvloop:
031B   1003           01214     clrc          ; Set quotient bit to 0
                      01215                      ; Shift left dividend and quotient
Message[305]: Using default destination of 1 (file).
031C   0DAF           01216     rlf     divid0    ; lsb
Message[305]: Using default destination of 1 (file).
031D   0DB0           01217     rlf     divid1
Message[305]: Using default destination of 1 (file).
031E   0DB1           01218     rlf     divid2
Message[305]: Using default destination of 1 (file).
031F   0DB2           01219     rlf     divid3    ; lsb into carry
Message[305]: Using default destination of 1 (file).
0320   0DAC           01220     rlf     remdrL    ; and then into partial remainder
Message[305]: Using default destination of 1 (file).
0321   0DAD           01221     rlf     remdrH
                      01222 
0322   1803           01223     skpnc         ; Check for overflow
0323   2???           01224     goto    subd
0324   082B           01225     movfw   divisH  ; Compare partial remainder and divisor
0325   022D           01226     subwf   remdrH,w
0326   1D03           01227     skpz
0327   2???           01228     goto    testgt   ; Not equal so test if remdrH is greater
0328   082A           01229     movfw   divisL  ; High bytes are equal, compare low bytes
0329   022C           01230     subwf   remdrL,w
032A                  01231 testgt:
032A   1C03           01232     skpc          ; Carry set if remdr >= divis
032B   2???           01233     goto    remrlt
                      01234 
032C                  01235 subd:
032C   082A           01236     movfw   divisL  ; Subtract divisor from partial remainder
Message[305]: Using default destination of 1 (file).
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

032D   02AC           01237     subwf   remdrL
032E   1C03           01238     skpc          ; Test for borrow
                      01239 
Message[305]: Using default destination of 1 (file).
032F   03AD           01240     decf    remdrH   ; Subtract borrow
0330   082B           01241     movfw   divisH
Message[305]: Using default destination of 1 (file).
0331   02AD           01242     subwf   remdrH
0332   142F           01243     bsf     divid0,0  ; Set quotient bit to 1
                      01244                      ; Quotient replaces dividend which is lost
0333                  01245 remrlt:
Message[305]: Using default destination of 1 (file).
0333   0BAE           01246     decfsz  bitcnt
0334   2???           01247     goto    dvloop
0335   0008           01248     return
                      01249 
                      01250 
                      01251 ; Untill further investigation, this functions need to be implemented explictly to
                      01252 ; each processor
                      01253 
0336                  01254 read_eeprom:
0336   1703           01255         bsf     STATUS, RP1
                      01256         ;; Take the preset W number, and take the byte from the addr
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0337   008D           01257         movwf   EEADR
0338   1683           01258         bsf     STATUS, RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0339   138C           01259         bcf     EECON1, EEPGD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
033A   140C           01260         bsf     EECON1, RD
033B   1283           01261         bcf     STATUS, RP0
                      01262         ;; Put the result in W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
033C   080C           01263         movf    EEDAT, W
033D   1303           01264         bcf     STATUS, RP1
033E   0008           01265         return
                      01266 
033F                  01267 write_eeprom:
033F   1703           01268         bsf     STATUS, RP1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0340   008C           01269         movwf   EEDAT ; write the value already in W to EEDAT, the data
0341   1303           01270         bcf     STATUS, RP1 ; Need this to get rc_nocoll
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0342   0827           01271         movf    rc_nocoll,W
0343   1703           01272         bsf     STATUS, RP1 ;; ^^^^^^^^^^^
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0344   008D           01273         movwf   EEADR
0345   1683           01274         bsf     STATUS, RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0346   138C           01275         bcf     EECON1, EEPGD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0347   150C           01276         bsf     EECON1, WREN
                      01277 
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01278         ; bcf   INTCON, GIE ; Well, GIE should be zero when it gets here
0348   3055           01279         movlw   0x55
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0349   008D           01280         movwf   EECON2
034A   30AA           01281         movlw   0xAA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
034B   008D           01282         movwf   EECON2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
034C   148C           01283         bsf     EECON1, WR
                      01284         ; bsf     INTCON, GIE
                      01285 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
034D   188C           01286         btfsc   EECON1, WR
034E   2???           01287         goto    $-1
                      01288 
                      01289 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
034F   110C           01290         bcf     EECON1, WREN
0350   1283           01291         bcf     STATUS, RP0
0351   1303           01292         bcf     STATUS, RP1
0352   0008           01293         return
                      01294 
0353                  01295 Delay_001_ms:
                      01296                         ;19 cycles
0353   3006           01297         movlw   0x06
0354   00A0           01298         movwf   dd1
0355                  01299 Delay_001_ms_loop:
0355   0BA0           01300         decfsz  dd1, f
0356   2???           01301         goto    Delay_001_ms_loop
0357   0008           01302         return
                      01303 
0358                  01304 Delay_005_ms:
                      01305                         ;100 cycles
0358   3021           01306         movlw   0x21
0359   00A0           01307         movwf   dd1
035A                  01308 Delay_005_ms_loop:
035A   0BA0           01309         decfsz  dd1, f
035B   2???           01310         goto    Delay_005_ms_loop
035C   0008           01311     return
                      01312 
Warning[205]: Found directive in column 1. (end)
30D4                  01313 end
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 62


SYMBOL TABLE
  LABEL                             VALUE 

ABDEN                             00000000
ABDOVF                            00000007
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ANS0                              00000000
ANS1                              00000001
ANS10                             00000002
ANS11                             00000003
ANS2                              00000002
ANS3                              00000003
ANS4                              00000004
ANS5                              00000005
ANS6                              00000006
ANS7                              00000007
ANS8                              00000000
ANS9                              00000001
ANSEL                             0000011E
ANSELH                            0000011F
ARC_16F                           1
BAUDCTL                           0000009B
BF                                00000000
BRG0                              00000000
BRG1                              00000001
BRG10                             00000002
BRG11                             00000003
BRG12                             00000004
BRG13                             00000005
BRG14                             00000006
BRG15                             00000007
BRG16                             00000003
BRG2                              00000002
BRG3                              00000003
BRG4                              00000004
BRG5                              00000005
BRG6                              00000006
BRG7                              00000007
BRG8                              00000000
BRG9                              00000001
BRGH                              00000002
C                                 00000000
C1CH0                             00000000
C1CH1                             00000001
C1IE                              00000005
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 63


SYMBOL TABLE
  LABEL                             VALUE 

C1IF                              00000005
C1OE                              00000005
C1ON                              00000007
C1OUT                             00000006
C1POL                             00000004
C1R                               00000002
C1SEN                             00000005
C1VREN                            00000007
C2CH0                             00000000
C2CH1                             00000001
C2IE                              00000006
C2IF                              00000006
C2OE                              00000005
C2ON                              00000007
C2OUT                             00000006
C2POL                             00000004
C2R                               00000002
C2REN                             00000004
C2SYNC                            00000000
C2VREN                            00000006
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCPR                              00000015
CCPR1H                            00000016
CCPR1L                            00000015
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CKE                               00000006
CKP                               00000004
CM1CON0                           00000119
CM2CON0                           0000011A
CM2CON1                           0000011B
CREN                              00000004
CSRC                              00000007
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DEV_ID1                           0
DEV_ID2                           0
DEV_ID3                           0
DEV_ID4                           200
D_A                               00000005
D_NOT_A                           00000005
Delay                             0000041F
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 64


SYMBOL TABLE
  LABEL                             VALUE 

Delay_0                           00000426
Delay_001_ms                      00000353
Delay_001_ms_loop                 00000355
Delay_005_ms                      00000358
Delay_005_ms_loop                 0000035A
ECCPAS                            0000001D
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDAT                             0000010C
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
F                                 00000001
FERR                              00000002
FSR                               00000004
GIE                               00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
HTS                               00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IOC                               00000096
IOC0                              00000000
IOC1                              00000001
IOC2                              00000002
IOC3                              00000003
IOC4                              00000004
IOC5                              00000005
IOCA                              00000096
IOCA0                             00000000
IOCA1                             00000001
IOCA2                             00000002
IOCA3                             00000003
IOCA4                             00000004
IOCA5                             00000005
IOCB                              00000116
IOCB4                             00000004
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 65


SYMBOL TABLE
  LABEL                             VALUE 

IOCB5                             00000005
IOCB6                             00000006
IOCB7                             00000007
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRP                               00000007
Init                              0000000A
LTS                               00000001
MC1OUT                            00000007
MC2OUT                            00000006
MSK                               00000093
MSK0                              00000000
MSK1                              00000001
MSK2                              00000002
MSK3                              00000003
MSK4                              00000004
MSK5                              00000005
MSK6                              00000006
MSK7                              00000007
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RABPU                         00000007
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_W                             00000002
NOT_WRITE                         00000002
OERR                              00000001
OPTION_REG                        00000081
OSCCON                            0000008F
OSCTUNE                           00000090
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000003
OUTNUM                            4
OUTREG                            PORTB
P                                 00000004
P1M0                              00000006
P1M1                              00000007
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 66


SYMBOL TABLE
  LABEL                             VALUE 

PEIE                              00000006
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PR2                               00000092
PRSEN                             00000007
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PSTRCON                           0000019D
PULSR                             00000002
PULSS                             00000003
PWM1CON                           0000001C
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RABIE                             00000003
RABIF                             00000000
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_EEPROM                       read_eeprom
READ_WRITE                        00000002
REC_CUSTOM_JUMP                   custom_command_handler
REC_SPB_PARAMETERS                spb_parameters
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 67


SYMBOL TABLE
  LABEL                             VALUE 

RP0                               00000005
RP1                               00000006
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SBOREN                            00000004
SCKP                              00000004
SCS                               00000000
SENB                              00000003
SENDB                             00000003
SMP                               00000007
SPBRG                             00000099
SPBRGH                            0000009A
SPEEDLIB_RESPONSE_DELAY           9
SPEN                              00000007
SR0                               00000006
SR1                               00000007
SRCON                             0000019E
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000093
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
STRA                              00000000
STRB                              00000001
STRC                              00000002
STRD                              00000003
STRSYNC                           00000004
SWDTEN                            00000000
SYNC                              00000004
Stable                            00000019
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1GINV                            00000007
T1GSS                             00000001
T1IE                              00000000
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 68


SYMBOL TABLE
  LABEL                             VALUE 

T1IF                              00000000
T1OSCEN                           00000003
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
T2IE                              00000001
T2IF                              00000001
TMR0                              00000001
TMR1                              0000000E
TMR1CS                            00000001
TMR1GE                            00000006
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX9                               00000006
TX9D                              00000000
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 69


SYMBOL TABLE
  LABEL                             VALUE 

TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
ULPWUE                            00000005
USER_NO_BANK_SPACE                0x67
USER_VARIABLE_SPACE               0x20
VCFG                              00000006
VP6EN                             00000004
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             00000118
VRR                               00000005
W                                 00000000
WCOL                              00000007
WDTCON                            00000097
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WPU                               00000095
WPU0                              00000000
WPU1                              00000001
WPU2                              00000002
WPU4                              00000004
WPU5                              00000005
WPUA                              00000095
WPUA0                             00000000
WPUA1                             00000001
WPUA2                             00000002
WPUA4                             00000004
WPUA5                             00000005
WPUB                              00000115
WPUB4                             00000004
WPUB5                             00000005
WPUB6                             00000006
WPUB7                             00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WRITE_EEPROM                      write_eeprom
WUE                               00000001
Z                                 00000002
_.org_1_012F                      0000012F
_.org_1_034E                      0000034E
_BOD_NSLEEP                       00003EFF
_BOD_OFF                          00003CFF
_BOD_ON                           00003FFF
_BOD_SBODEN                       00003DFF
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 70


SYMBOL TABLE
  LABEL                             VALUE 

_BOREN_NSLEEP                     00003EFF
_BOREN_OFF                        00003CFF
_BOREN_ON                         00003FFF
_BOREN_SBODEN                     00003DFF
_BOR_NSLEEP                       00003EFF
_BOR_OFF                          00003CFF
_BOR_ON                           00003FFF
_BOR_SBODEN                       00003DFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003F7F
_CP_OFF                           00003FFF
_CP_ON                            00003FBF
_DEVID1                           00002006
_EC_OSC                           00003FFB
_EXTRC                            00003FFF
_EXTRCIO                          00003FFE
_EXTRC_OSC_CLKOUT                 00003FFF
_EXTRC_OSC_NOCLKOUT               00003FFE
_FCMEN_OFF                        000037FF
_FCMEN_ON                         00003FFF
_FOSC_EC                          00003FFB
_FOSC_EXTRCCLK                    00003FFF
_FOSC_EXTRCIO                     00003FFE
_FOSC_HS                          00003FFA
_FOSC_INTRCCLK                    00003FFD
_FOSC_INTRCIO                     00003FFC
_FOSC_LP                          00003FF8
_FOSC_XT                          00003FF9
_HS_OSC                           00003FFA
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_IESO_OFF                         00003BFF
_IESO_ON                          00003FFF
_INTOSC                           00003FFD
_INTOSCIO                         00003FFC
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_LP_OSC                           00003FF8
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FEF
_WDTE_OFF                         00003FF7
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FF7
_WDT_ON                           00003FFF
_XT_OSC                           00003FF9
__16F690                          00000001
adress1                           000000AB
adress2                           000000AC
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 71


SYMBOL TABLE
  LABEL                             VALUE 

baud                              00004B00
beep_on_movmentc                  00000038
beep_on_pir_movment               00000064
beep_on_pir_movment_ret           0000007E
bitcnt                            0000002E
brgdiv                            00000004
brgval                            00000067
clock                             00000008
crc0                              000000AE
crc1                              000000AF
crccalc                           000003AE
crcloop                           000000B0
crcloopr                          000003A9
crcsend                           000003ED
crctmp                            000000B1
csum                              00000029
custom_command_handler            0000030E
d1                                000000A0
d1_tmp                            00000072
d2                                000000A1
d2_tmp                            00000073
d3                                000000A2
d3_tmp                            00000074
d4                                000000A3
dd1                               00000020
dd2                               00000021
dd3                               00000022
divid0                            0000002F
divid1                            00000030
divid2                            00000031
divid3                            00000032
divide                            00000317
divisH                            0000002B
divisL                            0000002A
dvloop                            0000031B
endflag                           000003F6
framelen                          000000B2
func_bc                           0000021A
func_bc_01                        00000266
func_bc_devid                     00000239
func_bc_sendaddr                  00000273
func_bc_sendaddr_devid_resp       00000262
func_bc_sendaddr_noresp           000002AB
func_check_response               000001EB
func_is_ocupied_send_response     000001EF
func_is_ocupied_send_response_go  000001F6
func_is_ocupied_send_response_pa  000001F8
func_rand_addr                    00000304
func_send_iam_here                000002DA
func_send_response                000001C9
func_set_rsp_addr                 0000031A
func_setport                      00000312
func_speedlib_config              0000013B
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 72


SYMBOL TABLE
  LABEL                             VALUE 

func_speedlib_config_basics       00000197
func_speedlib_config_caddr        00000151
func_speedlib_config_caddr_f      00000167
func_speedlib_config_extended     00000144
get_humtemp                       00000314
handle_response                   00000329
handle_response_loop              00000335
handle_response_ret               00000344
hum_parameter                     00000035
humrem_parameter                  00000036
if_parameter                      
init_speedlib                     00000000
intserv                           00000041
intserv_norm                      00000049
led_on_pir_movment                0000005D
lfsr_func                         00000413
lopp                              000003E8
main                              0000004D
main_commands                     00000028
main_ret1                         00000058
main_ret2                         0000005C
rand                              000000A4
rc1                               000000CB
rc10                              000000D4
rc11                              000000D5
rc12                              000000D6
rc13                              000000D7
rc14                              000000D8
rc15                              000000D9
rc16                              000000DA
rc17                              000000DB
rc18                              000000DC
rc19                              000000DD
rc2                               000000CC
rc20                              000000DE
rc3                               000000CD
rc4                               000000CE
rc5                               000000CF
rc6                               000000D0
rc7                               000000D1
rc8                               000000D2
rc9                               000000D3
rc_add_byte                       000000A8
rc_counter                        000000A6
rc_listen                         000000A5
rc_nocoll                         000000A7
rcframe                           000000CA
read_eeprom                       00000336
read_humtemp                      0000023F
read_humtemp_delay                000002A6
read_humtemp_delay_loop           000002AA
read_humtemp_loop1                00000256
read_humtemp_ret                  000002A0
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 73


SYMBOL TABLE
  LABEL                             VALUE 

read_humtemp_wait                 000002A1
rec                               0000006F
rec_oops_coll                     0000007D
rec_start                         00000081
reccrcfail                        00000349
reccrcfail_end                    00000351
recend                            000000CA
recend_no_broadcast               00000103
recend_tmp                        000000FE
recerror                          00000355
recsave                           00000095
recsave_add                       000000B9
recsave_set                       000000A3
recsave_unescape                  000000A7
recsave_unescape_1                000000B5
recsave_unescape_2                000000B7
recx                              0000008C
remdrH                            0000002D
remdrL                            0000002C
remrlt                            00000333
restore                           0000005D
restore_norm                      0000005F
rsp_adress1                       000000A9
rsp_adress2                       000000AA
send                              000003E3
send_humtemp                      000002E0
set_humtemp_parameter             000002B4
spb_bool_params                   00000037
spb_getparameters_beep            00000215
spb_getparameters_beep_off        00000236
spb_getparameters_beep_on         00000231
spb_getparameters_beep_ret        0000023B
spb_getparameters_led             00000167
spb_getparameters_led_off         00000188
spb_getparameters_led_on          00000183
spb_getparameters_led_ret         0000018D
spb_getparameters_pir_beep        000001DB
spb_getparameters_pir_beep_off    000001FC
spb_getparameters_pir_beep_on     000001F7
spb_getparameters_pir_beep_ret    00000201
spb_getparameters_pir_led         000001A1
spb_getparameters_pir_led_off     000001C2
spb_getparameters_pir_led_on      000001BD
spb_getparameters_pir_led_ret     000001C7
spb_parameters                    00000080
spb_parameters_beep               000000B4
spb_parameters_hum                000000F4
spb_parameters_led                000000AC
spb_parameters_light              0000011C
spb_parameters_pir_beep           000000C4
spb_parameters_pir_led            000000BC
spb_parameters_temp               000000CC
spb_setparameters_beep            00000205
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 74


SYMBOL TABLE
  LABEL                             VALUE 

spb_setparameters_beep_off        00000211
spb_setparameters_beep_on         0000020D
spb_setparameters_led             00000157
spb_setparameters_led_off         00000163
spb_setparameters_led_on          0000015F
spb_setparameters_pir_beep        000001CB
spb_setparameters_pir_beep_off    000001D7
spb_setparameters_pir_beep_on     000001D3
spb_setparameters_pir_led         00000191
spb_setparameters_pir_led_off     0000019D
spb_setparameters_pir_led_on      00000199
speedlib_config                   000000AD
speedlib_main                     00000075
subd                              0000032C
temp_below_zero                   000002D8
temp_parameter                    00000033
temprem_parameter                 00000034
testgt                            0000032A
tmp_STATUS                        00000071
tmp_W                             00000070
trd                               00000403
tx1                               000000B6
tx10                              000000BF
tx11                              000000C0
tx12                              000000C1
tx13                              000000C2
tx14                              000000C3
tx15                              000000C4
tx16                              000000C5
tx17                              000000C6
tx18                              000000C7
tx19                              000000C8
tx2                               000000B7
tx20                              000000C9
tx3                               000000B8
tx4                               000000B9
tx5                               000000BA
tx6                               000000BB
tx7                               000000BC
tx8                               000000BD
tx9                               000000BE
tx_send                           00000366
tx_send_escape_1                  0000038C
tx_send_escape_2                  00000391
tx_send_noescape                  00000372
tx_send_noescape_k                00000389
tx_send_noescape_l                00000383
txdo                              00000396
txdo2                             000003D3
txframe                           000000B5
txoops                            0000035A
txreturn                          000000B4
txtmp                             000000B3
MPASM  5.50  /HOME/MOONSHINE/SPEEDBUS/PIC/MPL   1-11-2015  20:58:33         PAGE 75


SYMBOL TABLE
  LABEL                             VALUE 

v_reset                           00000005
w1                                00000023
w2                                00000024
w3                                00000025
w4                                00000026
w5                                00000027
write_eeprom                      0000033F

Errors   :     0
Warnings :     6 reported,     0 suppressed
Messages :   405 reported,     0 suppressed

